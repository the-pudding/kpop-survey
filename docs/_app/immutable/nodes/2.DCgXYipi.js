function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["../chunks/browser.Dyv4tp0p.js","../chunks/viewport.jz3Xj8od.js","../chunks/index.PWopmgje.js","../chunks/scheduler.ca0irZJO.js"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
import{n as ce,I as wn,s as gt,e as R,k as Dt,U as ss,c as C,d as k,p as v,f as O,X as is,i as Ee,F as Bt,t as st,j as Pe,a as de,b as it,l as xe,W as Je,g as ot,G as os,a4 as as,q as Cr,a3 as Pr,V as bn,r as En,h as ls,o as cs,a6 as xr}from"../chunks/scheduler.ca0irZJO.js";import{n as us,l as hs,h as ds,j as fs,S as mt,i as pt,k as Lr,t as ge,g as Tn,a as _e,c as kn,b as It,d as Rt,m as Ct,e as Pt}from"../chunks/index.BJpDqVgO.js";import{e as Ve,u as On,f as Sn}from"../chunks/each.DpGXEzuz.js";import"../chunks/transform.W7TN51b0.js";import{v as gs}from"../chunks/viewport.jz3Xj8od.js";import{_ as Ke}from"../chunks/preload-helper.BQ24v_F8.js";function An(n,e,t,r){if(!e)return ce;const s=n.getBoundingClientRect();if(e.left===s.left&&e.right===s.right&&e.top===s.top&&e.bottom===s.bottom)return ce;const{delay:i=0,duration:o=300,easing:a=wn,start:l=us()+i,end:u=l+o,tick:c=ce,css:h}=t(n,{from:e,to:s},r);let d=!0,f=!1,g;function m(){h&&(g=ds(n,0,1,o,i,a,h)),i||(f=!0)}function p(){h&&fs(n,g),d=!1}return hs(_=>{if(!f&&_>=l&&(f=!0),f&&_>=u&&(c(1,0),p()),!d)return!1;if(f){const y=_-l,T=0+1*a(y/o);c(T,1-T)}return!0}),m(),c(0,1),p}function Dn(n){const e=getComputedStyle(n);if(e.position!=="absolute"&&e.position!=="fixed"){const{width:t,height:r}=e,s=n.getBoundingClientRect();n.style.position="absolute",n.style.width=t,n.style.height=r,ms(n,s)}}function ms(n,e){const t=n.getBoundingClientRect();if(e.left!==t.left||e.top!==t.top){const r=getComputedStyle(n),s=r.transform==="none"?"":r.transform;n.style.transform=`${s} translate(${e.left-t.left}px, ${e.top-t.top}px)`}}function jr(n,e,t){const r=n.slice();return r[5]=e[t],r}function $r(n){let e,t;return{c(){e=R("link"),this.h()},l(r){e=C(r,"LINK",{rel:!0,href:!0,as:!0,type:!0,crossorigin:!0}),this.h()},h(){v(e,"rel","preload"),v(e,"href",t=n[5]),v(e,"as","font"),v(e,"type","font/woff2"),v(e,"crossorigin","")},m(r,s){Ee(r,e,s)},p(r,s){s&16&&t!==(t=r[5])&&v(e,"href",t)},d(r){r&&k(e)}}}function ps(n){let e,t,r,s,i,o,a,l,u,c,h,d,f,g,m,p,_,y,T,w,b,I,A,z,V,Q;document.title=e=n[0];let ee=Ve(n[4]),x=[];for(let P=0;P<ee.length;P+=1)x[P]=$r(jr(n,ee,P));return{c(){t=R("meta"),r=R("meta"),s=R("meta"),i=R("meta"),o=R("meta"),a=R("meta"),l=R("meta"),u=R("meta"),c=R("meta"),h=R("meta"),f=R("meta"),g=R("meta"),m=R("meta"),p=R("meta"),_=R("meta"),y=R("meta"),T=R("meta"),w=R("meta"),b=R("meta"),A=R("meta"),z=R("link");for(let P=0;P<x.length;P+=1)x[P].c();Q=Dt(),this.h()},l(P){const E=ss("svelte-1htu80s",document.head);t=C(E,"META",{name:!0,content:!0}),r=C(E,"META",{name:!0,content:!0}),s=C(E,"META",{name:!0,content:!0}),i=C(E,"META",{property:!0,content:!0}),o=C(E,"META",{property:!0,content:!0}),a=C(E,"META",{property:!0,content:!0}),l=C(E,"META",{property:!0,content:!0}),u=C(E,"META",{property:!0,content:!0}),c=C(E,"META",{property:!0,content:!0}),h=C(E,"META",{property:!0,content:!0}),f=C(E,"META",{property:!0,content:!0}),g=C(E,"META",{property:!0,content:!0}),m=C(E,"META",{property:!0,content:!0}),p=C(E,"META",{name:!0,content:!0}),_=C(E,"META",{name:!0,content:!0}),y=C(E,"META",{name:!0,content:!0}),T=C(E,"META",{name:!0,content:!0}),w=C(E,"META",{name:!0,content:!0}),b=C(E,"META",{name:!0,content:!0}),A=C(E,"META",{name:!0,content:!0}),z=C(E,"LINK",{rel:!0,href:!0});for(let j=0;j<x.length;j+=1)x[j].l(E);Q=Dt(),E.forEach(k),this.h()},h(){v(t,"name","description"),v(t,"content",n[1]),v(r,"name","author"),v(r,"content","The Pudding"),v(s,"name","news_keywords"),v(s,"content",n[3]),v(i,"property","og:title"),v(i,"content",n[0]),v(o,"property","og:site_name"),v(o,"content","The Pudding"),v(a,"property","og:url"),v(a,"content",n[2]),v(l,"property","og:description"),v(l,"content",n[1]),v(u,"property","og:type"),v(u,"content","article"),v(c,"property","og:locale"),v(c,"content","en_US"),v(h,"property","og:image"),v(h,"content",d=n[2]+"/assets/social-facebook.jpg"),v(f,"property","og:image:type"),v(f,"content","image/jpeg"),v(g,"property","og:image:width"),v(g,"content","1200"),v(m,"property","og:image:height"),v(m,"content","600"),v(p,"name","twitter:card"),v(p,"content","summary_large_image"),v(_,"name","twitter:site"),v(_,"content","https://pudding.cool"),v(y,"name","twitter:creator"),v(y,"content","@puddingviz"),v(T,"name","twitter:title"),v(T,"content",n[0]),v(w,"name","twitter:description"),v(w,"content",n[1]),v(b,"name","twitter:image:src"),v(b,"content",I=n[2]+"/assets/social-twitter.jpg"),v(A,"name","robots"),v(A,"content","max-image-preview:large"),v(z,"rel","canonical"),v(z,"href",V=n[2]+"/")},m(P,E){O(document.head,t),O(document.head,r),O(document.head,s),O(document.head,i),O(document.head,o),O(document.head,a),O(document.head,l),O(document.head,u),O(document.head,c),O(document.head,h),O(document.head,f),O(document.head,g),O(document.head,m),O(document.head,p),O(document.head,_),O(document.head,y),O(document.head,T),O(document.head,w),O(document.head,b),O(document.head,A),O(document.head,z);for(let j=0;j<x.length;j+=1)x[j]&&x[j].m(document.head,null);O(document.head,Q)},p(P,[E]){if(E&1&&e!==(e=P[0])&&(document.title=e),E&2&&v(t,"content",P[1]),E&8&&v(s,"content",P[3]),E&1&&v(i,"content",P[0]),E&4&&v(a,"content",P[2]),E&2&&v(l,"content",P[1]),E&4&&d!==(d=P[2]+"/assets/social-facebook.jpg")&&v(h,"content",d),E&1&&v(T,"content",P[0]),E&2&&v(w,"content",P[1]),E&4&&I!==(I=P[2]+"/assets/social-twitter.jpg")&&v(b,"content",I),E&4&&V!==(V=P[2]+"/")&&v(z,"href",V),E&16){ee=Ve(P[4]);let j;for(j=0;j<ee.length;j+=1){const Te=jr(P,ee,j);x[j]?x[j].p(Te,E):(x[j]=$r(Te),x[j].c(),x[j].m(Q.parentNode,Q))}for(;j<x.length;j+=1)x[j].d(1);x.length=ee.length}},i:ce,o:ce,d(P){k(t),k(r),k(s),k(i),k(o),k(a),k(l),k(u),k(c),k(h),k(f),k(g),k(m),k(p),k(_),k(y),k(T),k(w),k(b),k(A),k(z),is(x,P),k(Q)}}}function vs(n,e,t){let{title:r="Title TK"}=e,{description:s="Description TK"}=e,{url:i="https://pudding.cool"}=e,{keywords:o=""}=e,{preloadFont:a=[]}=e;return n.$$set=l=>{"title"in l&&t(0,r=l.title),"description"in l&&t(1,s=l.description),"url"in l&&t(2,i=l.url),"keywords"in l&&t(3,o=l.keywords),"preloadFont"in l&&t(4,a=l.preloadFont)},[r,s,i,o,a]}class ys extends mt{constructor(e){super(),pt(this,e,vs,ps,gt,{title:0,description:1,url:2,keywords:3,preloadFont:4})}}const _s=[{name:"Seo Taiji & Kids (서태지와 아이들)",id:"1","debut year":"1992","debut song":"I Know (난 알아요)","debut song link":"https://www.youtube.com/watch?v=OEDHEzs5kyk","highest mv views":"Come Back Home","highest mv link":"https://youtu.be/q3xy4p2JTfU?si=ykWzTIrIAda-Ttn5",image:"ntf"},{name:"H.O.T",id:"2","debut year":"1996","debut song":"Age of Violence (전사의 후예)","debut song link":"https://www.youtube.com/watch?v=7ggXa28ADLE","highest mv views":"Candy","highest mv link":"https://youtu.be/3NUaXU1d-NY?si=guXk0ojaXtw4DSKl",image:"ntf"},{name:"S.E.S.",id:"3","debut year":"1997","debut song":"('Cause) I'm Your Girl","debut song link":"https://www.youtube.com/watch?v=fBge8oUfFwU","highest mv views":"Dreams Come True","highest mv link":"https://youtu.be/8uiR4SrDGZk?si=1KPA6DJk7Y7VQR0d",image:"small"},{name:"TVXQ! (동방신기)",id:"4","debut year":"2003","debut song":"Hug","debut song link":"https://www.youtube.com/watch?v=xQ635vE2RQI","highest mv views":"Mirotic (주문)","highest mv link":"https://youtu.be/HtJS32n6LNQ?si=Wrycm3J7W8dCvKhS",image:"DISCUSS"},{name:"Super Junior",id:"5","debut year":"2005","debut song":"Twins (Knock Out)","debut song link":"https://www.youtube.com/watch?v=SrazFGFRnhM","highest mv views":"Mr. Simple","highest mv link":"https://youtu.be/r6TwzSGYycM?si=5pJQL-PKNHicXXQD",image:""},{name:"BIGBANG",id:"6","debut year":"2006","debut song":"LA-LA-LA","debut song link":"https://www.youtube.com/watch?v=rc-cHSzK5-U","highest mv views":"BANG BANG BANG","highest mv link":"https://youtu.be/2ips2mM7Zqw?si=-QTJrxsJdsaeZXyi",image:"DISCUSS"},{name:"Girls' Generation (소녀시대)",id:"7","debut year":"2007","debut song":"Into The New World (다시 만난 세계)","debut song link":"https://www.youtube.com/watch?v=0k2Zzkw_-0I&list=RD0k2Zzkw_-0I&start_radio=1","highest mv views":"Gee","highest mv link":"https://youtu.be/U7mPqycQ0tQ?si=-yR2pROXaf8CTGZI",image:"small"},{name:"Wonder Girls",id:"8","debut year":"2007","debut song":"Irony","debut song link":"https://www.youtube.com/watch?v=uxFxoLxmcdg","highest mv views":"Nobody","highest mv link":"https://youtu.be/BA7fdSkp8ds?si=CKwWVeS6cKLQjYf1",image:"small"},{name:"2PM",id:"9","debut year":"2008","debut song":"10 out of 10 (10점 만점에 10점)","debut song link":"https://www.youtube.com/watch?v=YEmRoYV8vMs","highest mv views":"Hands Up","highest mv link":"https://youtu.be/KgrB2KBZws4?si=IbFU-25G968a5O9C",image:"small + low qual"},{name:"SHINee",id:"10","debut year":"2008","debut song":"Replay (누난 너무 예뻐)","debut song link":"https://www.youtube.com/watch?v=VTASffPQGhY","highest mv views":"Ring Ding Dong","highest mv link":"https://www.youtube.com/watch?v=roughtzsCDI",image:"small"},{name:"2NE1",id:"11","debut year":"2009","debut song":"FIRE","debut song link":"https://www.youtube.com/watch?v=49AfuuRbgGo","highest mv views":"I AM THE BEST (내가 제일 잘 나가)","highest mv link":"https://youtu.be/j7_lSP8Vc3o?si=oXben2BqG_scXRi7",image:"small + low qual"},{name:"BEAST",id:"12","debut year":"2009","debut song":"BAD GIRL","debut song link":"https://www.youtube.com/watch?v=fA_rXpyF67s","highest mv views":"FICTION","highest mv link":"https://youtu.be/ZAzWT8mRoR0?si=JkI2xh7yrkCY6i96",image:"DISCUSS - 6 member og B2ST or 4 member HIGHLIGHT"},{name:"f(x)",id:"13","debut year":"2009","debut song":"LA chA TA","debut song link":"https://www.youtube.com/watch?v=H7MHZpSNJQc","highest mv views":"Electric Shock","highest mv link":"https://youtu.be/n8I8QGFA1oM?si=yciZ5UmZCkxwp-Ay",image:"small + low qual"},{name:"miss A",id:"14","debut year":"2010","debut song":"Bad Girl, Good Girl","debut song link":"https://www.youtube.com/watch?v=8TeeJvcBdLA","highest mv views":"Only You (다른 남자 말고 너)","highest mv link":"https://youtu.be/zO9RzrhYR-I?si=e7EcbKbf3Bm0MhEI",image:"small + low qual"},{name:"SISTAR",id:"15","debut year":"2010","debut song":"Push Push","debut song link":"https://www.youtube.com/watch?v=75y5iN7z-08","highest mv views":"Alone (나혼자)","highest mv link":"https://youtu.be/E0ZHXVp_wUE?feature=shared",image:""},{name:"EXO",id:"16","debut year":"2012","debut song":"Mama","debut song link":"https://www.youtube.com/watch?v=KH6ZwnqZ7Wo","highest mv views":"Love Shot","highest mv link":"https://www.youtube.com/watch?v=pSudEWBAYRE",image:""},{name:"BTS (방탄소년단)",id:"17","debut year":"2013","debut song":"No More Dream","debut song link":"https://www.youtube.com/watch?v=rBG5L7UsUxA","highest mv views":"Dynamite","highest mv link":"https://www.youtube.com/watch?v=gdZLi9oWNZg",image:""},{name:"GOT7",id:"18","debut year":"2014","debut song":"Girls Girls Girls","debut song link":"https://www.youtube.com/watch?v=2sAoKmg7qPI","highest mv views":"Just right","highest mv link":"https://youtu.be/vrdk3IGcau8?feature=shared",image:"small + low qual"},{name:"MAMAMOO",id:"19","debut year":"2014","debut song":"Mr. Ambiguous (Mr.애매모호)","debut song link":"https://www.youtube.com/watch?v=QwjWP2Tnsjk","highest mv views":"HIP","highest mv link":"https://youtu.be/KhTeiaCezwM?feature=shared",image:"small"},{name:"Red Velvet",id:"20","debut year":"2014","debut song":"Happiness (행복)","debut song link":"https://youtu.be/JFgv8bKfxEs?si=Bg8hr6quDJP9Inug","highest mv views":"Bad Boy","highest mv link":"https://youtu.be/J_CFBjAyPWE?feature=shared",image:""},{name:"WINNER",id:"21","debut year":"2014","debut song":"Empty (공허해)","debut song link":"https://youtu.be/gEqlF5N8UMs?si=9bijM1O3ZHlW2hHl","highest mv views":"REALLY REALLY","highest mv link":"https://youtu.be/4tBnF46ybZk?feature=shared",image:"small"},{name:"GFRIEND (여자친구)",id:"22","debut year":"2015","debut song":"Glass Bead (유리구슬)","debut song link":"https://youtu.be/GU7icQFVzHo?si=BMHMgRNRXJ21JqNv","highest mv views":"MAGO","highest mv link":"https://youtu.be/LmBYPXGqtss?feature=shared",image:"small + low qual"},{name:"iKON",id:"23","debut year":"2015","debut song":"MY TYPE (취향저격)","debut song link":"https://youtu.be/ZS6vfv4sszg?si=gYgMU0_fU1nY57-Q","highest mv views":"Love Scenario","highest mv link":"https://youtu.be/vecSVX1QYbQ?feature=shared",image:"small + low qual"},{name:"OH MY GIRL",id:"24","debut year":"2015","debut song":"CUPID","debut song link":"https://youtu.be/fCrCUv6rQ7I?si=76PQlXLQx60PzA_8","highest mv views":"Nonstop","highest mv link":"https://www.youtube.com/watch?v=iDjQSdN_ig8",image:"small + low qual"},{name:"SEVENTEEN",id:"25","debut year":"2015","debut song":"Adore U (아낀다)","debut song link":"https://youtu.be/9rUFQJrCT7M?si=C61CfBTQ_dhAj8ZN","highest mv views":"Don't Wanna Cry (울고 싶지 않아)","highest mv link":"https://youtu.be/zEkg4GBQumc?feature=shared",image:""},{name:"TWICE",id:"26","debut year":"2015","debut song":"Like OOH-AHH (OOH-AHH하게)","debut song link":"https://youtu.be/0rtV5esQT6I?si=zv-CbcDtfQjYJX4k","highest mv views":"What is Love?","highest mv link":"https://www.youtube.com/watch?v=2sAoKmg7qPI",image:""},{name:"NCT",id:"27","debut year":"2016","debut song":"The 7th Sense (일곱 번째 감각)","debut song link":"https://youtu.be/3UGMDJ9kZCA?si=UmuCEnMzhDtVSeI4","highest mv views":"Make A Wish (Birthday Song)","highest mv link":"https://youtu.be/tyrVtwE8Gv0?feature=shared",image:""},{name:"I.O.I",id:"28","debut year":"2016","debut song":"Dream Girls","debut song link":"https://youtu.be/8Zu_yO4pNEY?si=JT0XwnUpANJ-EG9c","highest mv views":"Very Very Very (너무 너무 너무)","highest mv link":"https://youtu.be/GdxvD7r58ng?feature=shared",image:"small + low qual"},{name:"BLACKPINK",id:"29","debut year":"2016","debut song":"BOOMBAYAH","debut song link":"https://youtu.be/bwmSjveL3Lc?si=mbhaB5WSFjqzQV3W","highest mv views":"DDU-DU DDU-DU (뚜두뚜두) https://www.youtube.com/watch?v=IHNzOHi8sJs","highest mv link":"https://www.youtube.com/watch?v=IHNzOHi8sJs",image:""},{name:"Wanna One",id:"30","debut year":"2017","debut song":"Energetic","debut song link":"https://youtu.be/EVaV7AwqBWg?si=a_nadrDDFLqZVa1G","highest mv views":"Energetic","highest mv link":"https://youtu.be/EVaV7AwqBWg?si=a_nadrDDFLqZVa1G",image:"small + low qual"},{name:"Stray Kids",id:"31","debut year":"2018","debut song":"District 9","debut song link":"https://youtu.be/u6unJQownW4?si=JlN0wr_QLhKewSN-","highest mv views":"God's Menu (神메뉴)","highest mv link":"https://www.youtube.com/watch?v=TQTlCHxyuu8",image:""},{name:"(G)I-DLE ((여자)아이들)",id:"32","debut year":"2018","debut song":"LATATA","debut song link":"https://youtu.be/p4RIhcY7V3c?si=c_K87xUxsjn5BQGm","highest mv views":"Queencard (퀸카)","highest mv link":"https://youtu.be/7HDeem-JaSY?feature=shared",image:""},{name:"IZ*ONE",id:"33","debut year":"2018","debut song":"La Vie en Rose (라비앙로즈)","debut song link":"https://youtu.be/WZwr2a_lFWY?si=EcUcpAfwJMyE57i5","highest mv views":"Fiesta","highest mv link":"https://www.youtube.com/watch?v=eDEFolvLn0A",image:"small + low qual"},{name:"ITZY",id:"34","debut year":"2019","debut song":"DALLA DALLA (달라달라)","debut song link":"https://youtu.be/pNfTK39k55U?si=b6ESkvjDTKImWhY9","highest mv views":"WANNABE","highest mv link":"https://www.youtube.com/watch?v=fE2h3lGlOsk",image:""},{name:"TXT (TOMORROW X TOGETHER)",id:"35","debut year":"2019","debut song":"CROWN (어느날 머리에서 뿔이 자랐다)","debut song link":"https://youtu.be/W3iSnJ663II?si=fJMsbm94kuqfwpRs","highest mv views":"Blue Hour","highest mv link":"https://youtu.be/Vd9QkWsd5p4?feature=shared",image:""},{name:"TREASURE",id:"36","debut year":"2020","debut song":"BOY","debut song link":"https://youtu.be/JSAfPh1A25E?si=SbasbZ41-BLJYBnL","highest mv views":"JIKJIN (직진)","highest mv link":"https://youtu.be/ZJaKdBBzUYk?feature=shared",image:""},{name:"aespa",id:"37","debut year":"2020","debut song":"Black Mamba","debut song link":"https://youtu.be/ZeerrnuLi5E?si=S-gqX_sQc_hYSHz9","highest mv views":"Next Level","highest mv link":"https://youtu.be/4TWR90KJl84?feature=shared",image:""},{name:"ENHYPEN",id:"38","debut year":"2020","debut song":"Given-Taken","debut song link":"https://youtu.be/nQ6wLuYvGd4?si=eUedkwc1OFPAU8iH","highest mv views":"Drunk-Dazed","highest mv link":"https://youtu.be/Fc7-Oe0tj5k?si=KQnSczgAk-4sCDFq",image:"small"},{name:"IVE",id:"39","debut year":"2021","debut song":"ELEVEN","debut song link":"https://youtu.be/--FmExEAsM8?si=MDcAyaT_NVInfrBf","highest mv views":"After LIKE","highest mv link":"https://www.youtube.com/watch?v=F0B7HDiY-10&list=PLw6GjJYVtN0zhT0vdt1mWeBkgNr0sNwpp&index=3",image:""},{name:"Kep1er",id:"40","debut year":"2022","debut song":"WA DA DA","debut song link":"https://youtu.be/n0j5NPptyM0?si=436Z9gkZvSacjRUh","highest mv views":"WA DA DA","highest mv link":"https://youtu.be/n0j5NPptyM0?si=436Z9gkZvSacjRUh",image:""},{name:"NMIXX",id:"41","debut year":"2022","debut song":"O.O","debut song link":"https://youtu.be/3GWscde8rM8?si=RprVx2q7st8GycEk","highest mv views":"DICE","highest mv link":"https://youtu.be/p1bjnyDqI9k?si=jDucukb0Qvs-xs9h",image:""},{name:"LE SSERAFIM",id:"42","debut year":"2022","debut song":"FEARLESS","debut song link":"https://youtu.be/4vbDFu0PUew?si=2wiF8J4MbiNHfXIB","highest mv views":"ANTIFRAGILE","highest mv link":"https://youtu.be/pyf8cbqyfPs?si=pFVJTZDp_zxxe5eP",image:""},{name:"NewJeans",id:"43","debut year":"2022","debut song":"Attention","debut song link":"https://youtu.be/js1CtxSY38I?si=HHYtXwITAk5O8KvJ","highest mv views":"Super Shy","highest mv link":"https://youtu.be/ArmDp-zijuc?si=dgUEWpUVN1lWOran",image:"small"},{name:"BOYNEXTDOOR",id:"44","debut year":"2023","debut song":"Serenade","debut song link":"https://youtu.be/Uyq9OE8lIz8?si=oxaR8pLU5zieqlpC","highest mv views":"Earth, Wind & Fire","highest mv link":"https://www.youtube.com/watch?v=u9nP3qXQA4o",image:""},{name:"ZEROBASEONE",id:"45","debut year":"2023","debut song":"In Bloom","debut song link":"https://youtu.be/trzeUClQIIg?si=LxiBZRZ1Sv8SdG4g","highest mv views":"CRUSH (가시)","highest mv link":"https://www.youtube.com/watch?v=AZoZbtI67Yk",image:""},{name:"RIIZE",id:"46","debut year":"2023","debut song":"Get A Guitar","debut song link":"https://youtu.be/iUw3LPM7OBU?si=v1PxZ1HQOecnbFri","highest mv views":"Get A Guitar","highest mv link":"https://youtu.be/iUw3LPM7OBU?si=v1PxZ1HQOecnbFri",image:""},{name:"BABYMONSTER",id:"47","debut year":"2023","debut song":"Batter Up","debut song link":"https://youtu.be/olDWm2veCrM?si=hnAU6SGWrZJr9sUM","highest mv views":"Batter Up","highest mv link":"https://youtu.be/olDWm2veCrM?si=hnAU6SGWrZJr9sUM",image:""},{name:"TWS (투어스)",id:"48","debut year":"2024","debut song":"plot twist (첫 만남은 계획대로 되지 않아)","debut song link":"https://youtu.be/hVAc1Vf2ITU?si=E4eRB4Xt7zqx5xE4","highest mv views":"plot twist (첫 만남은 계획대로 되지 않아)","highest mv link":"https://youtu.be/hVAc1Vf2ITU?si=E4eRB4Xt7zqx5xE4",image:""},{name:"VCHA",id:"49","debut year":"2024","debut song":"Girls of the Year","debut song link":"https://youtu.be/rBHK8Z8cwmQ?si=azCvDC_7u-ZaancM","highest mv views":"Y.O.Universe","highest mv link":"https://youtu.be/M8EsxRh0zOc?si=WmBHbfOFxLClfNQg",image:""},{name:"ILLIT",id:"50","debut year":"2024","debut song":"Magnetic","debut song link":"https://www.youtube.com/watch?v=Vk5-c_v4gMU","highest mv views":"Magnetic","highest mv link":"https://www.youtube.com/watch?v=Vk5-c_v4gMU",image:""}];function ws(n){const e=n-1;return e*e*e+1}function In(n,{from:e,to:t},r={}){const s=getComputedStyle(n),i=s.transform==="none"?"":s.transform,[o,a]=s.transformOrigin.split(" ").map(parseFloat),l=e.left+e.width*o/t.width-(t.left+o),u=e.top+e.height*a/t.height-(t.top+a),{delay:c=0,duration:h=f=>Math.sqrt(f)*120,easing:d=ws}=r;return{delay:c,duration:Bt(h)?h(Math.sqrt(l*l+u*u)):h,easing:d,css:(f,g)=>{const m=g*l,p=g*u,_=f+g*e.width/t.width,y=f+g*e.height/t.height;return`transform: ${i} translate(${m}px, ${p}px) scale(${_}, ${y});`}}}function Nr(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(n,s).enumerable})),t.push.apply(t,r)}return t}function xt(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Nr(Object(t),!0).forEach(function(r){Ze(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):Nr(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function at(n){"@babel/helpers - typeof";return at=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},at(n)}function Ze(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function bs(n,e){if(n==null)return{};var t={},r=Object.keys(n),s,i;for(i=0;i<r.length;i++)s=r[i],!(e.indexOf(s)>=0)&&(t[s]=n[s]);return t}function Es(n,e){if(n==null)return{};var t=bs(n,e),r,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(n);for(s=0;s<i.length;s++)r=i[s],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(n,r)&&(t[r]=n[r])}return t}function Ts(n,e){return Os(n)||As(n,e)||vr(n,e)||Is()}function ne(n){return ks(n)||Ss(n)||vr(n)||Ds()}function ks(n){if(Array.isArray(n))return sr(n)}function Os(n){if(Array.isArray(n))return n}function Ss(n){if(typeof Symbol<"u"&&n[Symbol.iterator]!=null||n["@@iterator"]!=null)return Array.from(n)}function As(n,e){var t=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(t!=null){var r=[],s=!0,i=!1,o,a;try{for(t=t.call(n);!(s=(o=t.next()).done)&&(r.push(o.value),!(e&&r.length===e));s=!0);}catch(l){i=!0,a=l}finally{try{!s&&t.return!=null&&t.return()}finally{if(i)throw a}}return r}}function vr(n,e){if(n){if(typeof n=="string")return sr(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if(t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set")return Array.from(n);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return sr(n,e)}}function sr(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=n[t];return r}function Ds(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Is(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function vt(n,e){var t=typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(!t){if(Array.isArray(n)||(t=vr(n))||e&&n&&typeof n.length=="number"){t&&(n=t);var r=0,s=function(){};return{s,n:function(){return r>=n.length?{done:!0}:{done:!1,value:n[r++]}},e:function(l){throw l},f:s}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,o=!1,a;return{s:function(){t=t.call(n)},n:function(){var l=t.next();return i=l.done,l},e:function(l){o=!0,a=l},f:function(){try{!i&&t.return!=null&&t.return()}finally{if(o)throw a}}}}var Rs="finalize",Cs="consider";function Ye(n,e,t){n.dispatchEvent(new CustomEvent(Rs,{detail:{items:e,info:t}}))}function be(n,e,t){n.dispatchEvent(new CustomEvent(Cs,{detail:{items:e,info:t}}))}var Gt="draggedEntered",yt="draggedLeft",zt="draggedOverIndex",yr="draggedLeftDocument",Lt={LEFT_FOR_ANOTHER:"leftForAnother",OUTSIDE_OF_ANY:"outsideOfAny"};function Ps(n,e,t){n.dispatchEvent(new CustomEvent(Gt,{detail:{indexObj:e,draggedEl:t}}))}function xs(n,e,t){n.dispatchEvent(new CustomEvent(yt,{detail:{draggedEl:e,type:Lt.LEFT_FOR_ANOTHER,theOtherDz:t}}))}function Ls(n,e){n.dispatchEvent(new CustomEvent(yt,{detail:{draggedEl:e,type:Lt.OUTSIDE_OF_ANY}}))}function js(n,e,t){n.dispatchEvent(new CustomEvent(zt,{detail:{indexObj:e,draggedEl:t}}))}function $s(n){window.dispatchEvent(new CustomEvent(yr,{detail:{draggedEl:n}}))}var J={DRAG_STARTED:"dragStarted",DRAGGED_ENTERED:Gt,DRAGGED_ENTERED_ANOTHER:"dragEnteredAnother",DRAGGED_OVER_INDEX:zt,DRAGGED_LEFT:yt,DRAGGED_LEFT_ALL:"draggedLeftAll",DROPPED_INTO_ZONE:"droppedIntoZone",DROPPED_INTO_ANOTHER:"droppedIntoAnother",DROPPED_OUTSIDE_OF_ANY:"droppedOutsideOfAny",DRAG_STOPPED:"dragStopped"},Z={POINTER:"pointer",KEYBOARD:"keyboard"},Ht="isDndShadowItem",_r="data-is-dnd-shadow-item-internal",Ns="data-is-dnd-shadow-item-hint",Us="id:dnd-shadow-placeholder-0000",Ms="dnd-action-dragged-el",F="id",ir=0;function Rn(){ir++}function Cn(){if(ir===0)throw new Error("Bug! trying to decrement when there are no dropzones");ir--}var wr=typeof window>"u";function or(n){var e,t=n.getBoundingClientRect(),r=getComputedStyle(n),s=r.transform;if(s){var i,o,a,l;if(s.startsWith("matrix3d("))e=s.slice(9,-1).split(/, /),i=+e[0],o=+e[5],a=+e[12],l=+e[13];else if(s.startsWith("matrix("))e=s.slice(7,-1).split(/, /),i=+e[0],o=+e[3],a=+e[4],l=+e[5];else return t;var u=r.transformOrigin,c=t.x-a-(1-i)*parseFloat(u),h=t.y-l-(1-o)*parseFloat(u.slice(u.indexOf(" ")+1)),d=i?t.width/i:n.offsetWidth,f=o?t.height/o:n.offsetHeight;return{x:c,y:h,width:d,height:f,top:h,right:c+d,bottom:h+f,left:c}}else return t}function Pn(n){var e=or(n);return{top:e.top+window.scrollY,bottom:e.bottom+window.scrollY,left:e.left+window.scrollX,right:e.right+window.scrollX}}function xn(n){var e=n.getBoundingClientRect();return{top:e.top+window.scrollY,bottom:e.bottom+window.scrollY,left:e.left+window.scrollX,right:e.right+window.scrollX}}function Ln(n){return{x:(n.left+n.right)/2,y:(n.top+n.bottom)/2}}function Fs(n,e){return Math.sqrt(Math.pow(n.x-e.x,2)+Math.pow(n.y-e.y,2))}function qt(n,e){return n.y<=e.bottom&&n.y>=e.top&&n.x>=e.left&&n.x<=e.right}function ut(n){return Ln(xn(n))}function Ur(n,e){var t=ut(n),r=Pn(e);return qt(t,r)}function Bs(n,e){var t=ut(n),r=ut(e);return Fs(t,r)}function Gs(n){var e=xn(n);return e.right<0||e.left>document.documentElement.scrollWidth||e.bottom<0||e.top>document.documentElement.scrollHeight}var ze;function br(){ze=new Map}br();function zs(n){var e=Array.from(n.children).findIndex(function(t){return t.getAttribute(_r)});if(e>=0)return ze.has(n)||ze.set(n,new Map),ze.get(n).set(e,Pn(n.children[e])),e}function Hs(n,e){if(!Ur(n,e))return null;var t=e.children;if(t.length===0)return{index:0,isProximityBased:!0};for(var r=zs(e),s=0;s<t.length;s++)if(Ur(n,t[s])){var i=ze.has(e)&&ze.get(e).get(s);return i&&!qt(ut(n),i)?{index:r,isProximityBased:!1}:{index:s,isProximityBased:!1}}for(var o=Number.MAX_VALUE,a=void 0,l=0;l<t.length;l++){var u=Bs(n,t[l]);u<o&&(o=u,a=l)}return{index:a,isProximityBased:!0}}function bt(n){return JSON.stringify(n,null,2)}function jt(n){if(!n)throw new Error("cannot get depth of a falsy node");return jn(n,0)}function jn(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return n.parentElement?jn(n.parentElement,e+1):e-1}function qs(n,e){if(Object.keys(n).length!==Object.keys(e).length)return!1;for(var t in n)if(!{}.hasOwnProperty.call(e,t)||e[t]!==n[t])return!1;return!0}function Ws(n,e){if(n.length!==e.length)return!1;for(var t=0;t<n.length;t++)if(n[t]!==e[t])return!1;return!0}var Js=200,Mr=10,ar;function Vs(n,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Js,r=arguments.length>3?arguments[3]:void 0,s,i,o=!1,a,l=Array.from(e).sort(function(c,h){return jt(h)-jt(c)});function u(){var c=ut(n),h=r.multiScrollIfNeeded();if(!h&&a&&Math.abs(a.x-c.x)<Mr&&Math.abs(a.y-c.y)<Mr){ar=window.setTimeout(u,t);return}if(Gs(n)){$s(n);return}a=c;var d=!1,f=vt(l),g;try{for(f.s();!(g=f.n()).done;){var m=g.value;h&&br();var p=Hs(n,m);if(p!==null){var _=p.index;d=!0,m!==s?(s&&xs(s,n,m),Ps(m,p,n),s=m):_!==i&&(js(m,p,n),i=_);break}}}catch(y){f.e(y)}finally{f.f()}!d&&o&&s?(Ls(s,n),s=void 0,i=void 0,o=!1):o=!0,ar=window.setTimeout(u,t)}u()}function Ks(){clearTimeout(ar),br()}var tt=30;function Zs(){var n;function e(){n={directionObj:void 0,stepPx:0}}e();function t(i){var o=n,a=o.directionObj,l=o.stepPx;a&&(i.scrollBy(a.x*l,a.y*l),window.requestAnimationFrame(function(){return t(i)}))}function r(i){return tt-i}function s(i,o){if(!o)return!1;var a=Ys(i,o);if(a===null)return e(),!1;var l=!!n.directionObj,u=!1,c=!1;return o.scrollHeight>o.clientHeight&&(a.bottom<tt?(u=!0,n.directionObj={x:0,y:1},n.stepPx=r(a.bottom)):a.top<tt&&(u=!0,n.directionObj={x:0,y:-1},n.stepPx=r(a.top)),!l&&u)||o.scrollWidth>o.clientWidth&&(a.right<tt?(c=!0,n.directionObj={x:1,y:0},n.stepPx=r(a.right)):a.left<tt&&(c=!0,n.directionObj={x:-1,y:0},n.stepPx=r(a.left)),!l&&c)?(t(o),!0):(e(),!1)}return{scrollIfNeeded:s,resetScrolling:e}}function Ys(n,e){var t=e===document.scrollingElement?{top:0,bottom:window.innerHeight,left:0,right:window.innerWidth}:e.getBoundingClientRect();return qt(n,t)?{top:n.y-t.top,bottom:t.bottom-n.y,left:n.x-t.left,right:t.right-n.x}:null}function Xs(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],e=arguments.length>1?arguments[1]:void 0,t=ei(n),r=Array.from(t).sort(function(a,l){return jt(l)-jt(a)}),s=Zs(),i=s.scrollIfNeeded;function o(){var a=e();if(!a||!r)return!1;for(var l=r.filter(function(h){return qt(a,h.getBoundingClientRect())||h===document.scrollingElement}),u=0;u<l.length;u++){var c=i(a,l[u]);if(c)return!0}return!1}return{multiScrollIfNeeded:t.size>0?o:function(){return!1}}}function Qs(n){if(!n)return[];for(var e=[],t=n;t;){var r=window.getComputedStyle(t),s=r.overflow;s.split(" ").some(function(i){return i.includes("auto")||i.includes("scroll")})&&e.push(t),t=t.parentElement}return e}function ei(n){var e=new Set,t=vt(n),r;try{for(t.s();!(r=t.n()).done;){var s=r.value;Qs(s).forEach(function(i){return e.add(i)})}}catch(i){t.e(i)}finally{t.f()}return(document.scrollingElement.scrollHeight>document.scrollingElement.clientHeight||document.scrollingElement.scrollWidth>document.scrollingElement.clientHeight)&&e.add(document.scrollingElement),e}function ti(n){var e=n.cloneNode(!0),t=[],r=n.tagName==="SELECT",s=r?[n]:ne(n.querySelectorAll("select")),i=vt(s),o;try{for(i.s();!(o=i.n()).done;){var a=o.value;t.push(a.value)}}catch(T){i.e(T)}finally{i.f()}if(s.length>0)for(var l=r?[e]:ne(e.querySelectorAll("select")),u=0;u<l.length;u++){var c=l[u],h=t[u],d=c.querySelector('option[value="'.concat(h,'"'));d&&d.setAttribute("selected",!0)}var f=n.tagName==="CANVAS",g=f?[n]:ne(n.querySelectorAll("canvas"));if(g.length>0)for(var m=f?[e]:ne(e.querySelectorAll("canvas")),p=0;p<m.length;p++){var _=g[p],y=m[p];y.width=_.width,y.height=_.height,y.getContext("2d").drawImage(_,0,0)}return e}var ht=Object.freeze({USE_COMPUTED_STYLE_INSTEAD_OF_BOUNDING_RECT:"USE_COMPUTED_STYLE_INSTEAD_OF_BOUNDING_RECT"}),ri=Ze({},ht.USE_COMPUTED_STYLE_INSTEAD_OF_BOUNDING_RECT,!1);function $n(n){if(!ht[n])throw new Error("Can't get non existing feature flag ".concat(n,"! Supported flags: ").concat(Object.keys(ht)));return ri[n]}var ni=.2;function ke(n){return"".concat(n," ").concat(ni,"s ease")}function si(n,e){var t=n.getBoundingClientRect(),r=ti(n);Nn(n,r),r.id=Ms,r.style.position="fixed";var s=t.top,i=t.left;if(r.style.top="".concat(s,"px"),r.style.left="".concat(i,"px"),e){var o=Ln(t);s-=o.y-e.y,i-=o.x-e.x,window.setTimeout(function(){r.style.top="".concat(s,"px"),r.style.left="".concat(i,"px")},0)}return r.style.margin="0",r.style.boxSizing="border-box",r.style.height="".concat(t.height,"px"),r.style.width="".concat(t.width,"px"),r.style.transition="".concat(ke("top"),", ").concat(ke("left"),", ").concat(ke("background-color"),", ").concat(ke("opacity"),", ").concat(ke("color")," "),window.setTimeout(function(){return r.style.transition+=", ".concat(ke("width"),", ").concat(ke("height"))},0),r.style.zIndex="9999",r.style.cursor="grabbing",r}function ii(n){n.style.cursor="grab"}function oi(n,e,t,r){Nn(e,n);var s=e.getBoundingClientRect(),i=n.getBoundingClientRect(),o=s.width-i.width,a=s.height-i.height;if(o||a){var l={left:(t-i.left)/i.width,top:(r-i.top)/i.height};$n(ht.USE_COMPUTED_STYLE_INSTEAD_OF_BOUNDING_RECT)||(n.style.height="".concat(s.height,"px"),n.style.width="".concat(s.width,"px")),n.style.left="".concat(parseFloat(n.style.left)-l.left*o,"px"),n.style.top="".concat(parseFloat(n.style.top)-l.top*a,"px")}}function Nn(n,e){var t=window.getComputedStyle(n);Array.from(t).filter(function(r){return r.startsWith("background")||r.startsWith("padding")||r.startsWith("font")||r.startsWith("text")||r.startsWith("align")||r.startsWith("justify")||r.startsWith("display")||r.startsWith("flex")||r.startsWith("border")||r==="opacity"||r==="color"||r==="list-style-type"||$n(ht.USE_COMPUTED_STYLE_INSTEAD_OF_BOUNDING_RECT)&&(r==="width"||r==="height")}).forEach(function(r){return e.style.setProperty(r,t.getPropertyValue(r),t.getPropertyPriority(r))})}function ai(n,e){n.draggable=!1,n.ondragstart=function(){return!1},e?(n.style.userSelect="",n.style.WebkitUserSelect="",n.style.cursor=""):(n.style.userSelect="none",n.style.WebkitUserSelect="none",n.style.cursor="grab")}function Un(n){n.style.display="none",n.style.position="fixed",n.style.zIndex="-5"}function li(n){n.style.visibility="hidden",n.setAttribute(_r,"true")}function ci(n){n.style.visibility="",n.removeAttribute(_r)}function St(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:function(){},t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:function(){return[]};n.forEach(function(r){var s=e(r);Object.keys(s).forEach(function(i){r.style[i]=s[i]}),t(r).forEach(function(i){return r.classList.add(i)})})}function $t(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:function(){},t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:function(){return[]};n.forEach(function(r){var s=e(r);Object.keys(s).forEach(function(i){r.style[i]=""}),t(r).forEach(function(i){return r.classList.contains(i)&&r.classList.remove(i)})})}function ui(n){var e=n.style.minHeight;n.style.minHeight=window.getComputedStyle(n).getPropertyValue("height");var t=n.style.minWidth;return n.style.minWidth=window.getComputedStyle(n).getPropertyValue("width"),function(){n.style.minHeight=e,n.style.minWidth=t}}var hi="--any--",di=100,fi=20,Fr=3,Br={outline:"rgba(255, 255, 102, 0.7) solid 2px"},Gr="data-is-dnd-original-dragged-item",he,G,K,Wt,$,Jt,we,q,pe,X,Ie=!1,Er=!1,Tr,_t=!1,At=[],le=new Map,U=new Map,Yt=new WeakMap;function gi(n,e){le.has(e)||le.set(e,new Set),le.get(e).has(n)||(le.get(e).add(n),Rn())}function zr(n,e){le.get(e).delete(n),Cn(),le.get(e).size===0&&le.delete(e)}function mi(){var n=le.get(Wt),e=vt(n),t;try{for(e.s();!(t=e.n()).done;){var r=t.value;r.addEventListener(Gt,Mn),r.addEventListener(yt,Fn),r.addEventListener(zt,Bn)}}catch(a){e.e(a)}finally{e.f()}window.addEventListener(yr,Xe);var s=Math.max.apply(Math,ne(Array.from(n.keys()).map(function(a){return U.get(a).dropAnimationDurationMs}))),i=s===0?fi:Math.max(s,di),o=Xs(n,function(){return X});Vs(G,n,i*1.07,o)}function pi(){var n=le.get(Wt),e=vt(n),t;try{for(e.s();!(t=e.n()).done;){var r=t.value;r.removeEventListener(Gt,Mn),r.removeEventListener(yt,Fn),r.removeEventListener(zt,Bn)}}catch(s){e.e(s)}finally{e.f()}window.removeEventListener(yr,Xe),Ks()}function Vt(n){return n.findIndex(function(e){return!!e[Ht]})}function vi(n){var e;return xt(xt({},n),{},(e={},Ze(e,Ht,!0),Ze(e,F,Us),e))}function Mn(n){var e=U.get(n.currentTarget),t=e.items,r=e.dropFromOthersDisabled;if(!(r&&n.currentTarget!==$)){if(_t=!1,t=t.filter(function(c){return c[F]!==we[F]}),$!==n.currentTarget){var s=U.get($).items,i=s.filter(function(c){return!c[Ht]});be($,i,{trigger:J.DRAGGED_ENTERED_ANOTHER,id:K[F],source:Z.POINTER})}var o=n.detail.indexObj,a=o.index,l=o.isProximityBased,u=l&&a===n.currentTarget.children.length-1?a+1:a;q=n.currentTarget,t.splice(u,0,we),be(n.currentTarget,t,{trigger:J.DRAGGED_ENTERED,id:K[F],source:Z.POINTER})}}function Fn(n){if(Ie){var e=U.get(n.currentTarget),t=e.items,r=e.dropFromOthersDisabled;if(!(r&&n.currentTarget!==$&&n.currentTarget!==q)){var s=ne(t),i=Vt(s);i!==-1&&s.splice(i,1);var o=q;q=void 0;var a=n.detail,l=a.type,u=a.theOtherDz;if(l===Lt.OUTSIDE_OF_ANY||l===Lt.LEFT_FOR_ANOTHER&&u!==$&&U.get(u).dropFromOthersDisabled){_t=!0,q=$;var c=o===$?s:ne(U.get($).items);c.splice(Jt,0,we),be($,c,{trigger:J.DRAGGED_LEFT_ALL,id:K[F],source:Z.POINTER})}be(n.currentTarget,s,{trigger:J.DRAGGED_LEFT,id:K[F],source:Z.POINTER})}}}function Bn(n){var e=U.get(n.currentTarget),t=e.items,r=e.dropFromOthersDisabled;if(!(r&&n.currentTarget!==$)){var s=ne(t);_t=!1;var i=n.detail.indexObj.index,o=Vt(s);o!==-1&&s.splice(o,1),s.splice(i,0,we),be(n.currentTarget,s,{trigger:J.DRAGGED_OVER_INDEX,id:K[F],source:Z.POINTER})}}function Nt(n){n.preventDefault();var e=n.touches?n.touches[0]:n;X={x:e.clientX,y:e.clientY},G.style.transform="translate3d(".concat(X.x-pe.x,"px, ").concat(X.y-pe.y,"px, 0)")}function Xe(){Er=!0,window.removeEventListener("mousemove",Nt),window.removeEventListener("touchmove",Nt),window.removeEventListener("mouseup",Xe),window.removeEventListener("touchend",Xe),pi(),ii(G),q||(q=$);var n=U.get(q),e=n.items,t=n.type;$t(le.get(t),function(i){return U.get(i).dropTargetStyle},function(i){return U.get(i).dropTargetClasses});var r=Vt(e);r===-1&&q===$&&(r=Jt),e=e.map(function(i){return i[Ht]?K:i});function s(){Tr(),Ye(q,e,{trigger:_t?J.DROPPED_OUTSIDE_OF_ANY:J.DROPPED_INTO_ZONE,id:K[F],source:Z.POINTER}),q!==$&&Ye($,U.get($).items,{trigger:J.DROPPED_INTO_ANOTHER,id:K[F],source:Z.POINTER}),r!==-1&&ci(q.children[r]),wi()}yi(r,s)}function yi(n,e){var t=n>-1?or(q.children[n]):or(q),r={x:t.left-parseFloat(G.style.left),y:t.top-parseFloat(G.style.top)},s=U.get(q),i=s.dropAnimationDurationMs,o="transform ".concat(i,"ms ease");G.style.transition=G.style.transition?G.style.transition+","+o:o,G.style.transform="translate3d(".concat(r.x,"px, ").concat(r.y,"px, 0)"),window.setTimeout(e,i)}function _i(n,e){At.push({dz:n,destroy:e}),window.requestAnimationFrame(function(){Un(n),document.body.appendChild(n)})}function wi(){G.remove(),he.remove(),At.length&&(At.forEach(function(n){var e=n.dz,t=n.destroy;t(),e.remove()}),At=[]),G=void 0,he=void 0,K=void 0,Wt=void 0,$=void 0,Jt=void 0,we=void 0,q=void 0,pe=void 0,X=void 0,Ie=!1,Er=!1,Tr=void 0,_t=!1}function bi(n,e){var t=!1,r={items:void 0,type:void 0,flipDurationMs:0,dragDisabled:!1,morphDisabled:!1,dropFromOthersDisabled:!1,dropTargetStyle:Br,dropTargetClasses:[],transformDraggedElement:function(){},centreDraggedOnCursor:!1},s=new Map;function i(){window.addEventListener("mousemove",l,{passive:!1}),window.addEventListener("touchmove",l,{passive:!1,capture:!1}),window.addEventListener("mouseup",a,{passive:!1}),window.addEventListener("touchend",a,{passive:!1})}function o(){window.removeEventListener("mousemove",l),window.removeEventListener("touchmove",l),window.removeEventListener("mouseup",a),window.removeEventListener("touchend",a)}function a(){o(),he=void 0,pe=void 0,X=void 0}function l(d){d.preventDefault();var f=d.touches?d.touches[0]:d;X={x:f.clientX,y:f.clientY},(Math.abs(X.x-pe.x)>=Fr||Math.abs(X.y-pe.y)>=Fr)&&(o(),c())}function u(d){if(!(d.target!==d.currentTarget&&(d.target.value!==void 0||d.target.isContentEditable))&&!d.button&&!Ie){d.stopPropagation();var f=d.touches?d.touches[0]:d;pe={x:f.clientX,y:f.clientY},X=xt({},pe),he=d.currentTarget,i()}}function c(){Ie=!0;var d=s.get(he);Jt=d,$=he.parentElement;var f=$.closest("dialog")||$.getRootNode(),g=f.body||f,m=r.items,p=r.type,_=r.centreDraggedOnCursor,y=ne(m);K=y[d],Wt=p,we=vi(K),G=si(he,_&&X),he.setAttribute(Gr,!0);function T(){G.parentElement?window.requestAnimationFrame(T):(g.appendChild(G),G.focus(),mi(),Un(he),g.appendChild(he),we[F]=K[F])}window.requestAnimationFrame(T),St(Array.from(le.get(r.type)).filter(function(w){return w===$||!U.get(w).dropFromOthersDisabled}),function(w){return U.get(w).dropTargetStyle},function(w){return U.get(w).dropTargetClasses}),y.splice(d,1,we),Tr=ui($),be($,y,{trigger:J.DRAG_STARTED,id:K[F],source:Z.POINTER}),window.addEventListener("mousemove",Nt,{passive:!1}),window.addEventListener("touchmove",Nt,{passive:!1,capture:!1}),window.addEventListener("mouseup",Xe,{passive:!1}),window.addEventListener("touchend",Xe,{passive:!1})}function h(d){var f=d.items,g=f===void 0?void 0:f,m=d.flipDurationMs,p=m===void 0?0:m,_=d.type,y=_===void 0?hi:_,T=d.dragDisabled,w=T===void 0?!1:T,b=d.morphDisabled,I=b===void 0?!1:b,A=d.dropFromOthersDisabled,z=A===void 0?!1:A,V=d.dropTargetStyle,Q=V===void 0?Br:V,ee=d.dropTargetClasses,x=ee===void 0?[]:ee,P=d.transformDraggedElement,E=P===void 0?function(){}:P,j=d.centreDraggedOnCursor,Te=j===void 0?!1:j;r.dropAnimationDurationMs=p,r.type&&y!==r.type&&zr(n,r.type),r.type=y,r.items=ne(g),r.dragDisabled=w,r.morphDisabled=I,r.transformDraggedElement=E,r.centreDraggedOnCursor=Te,t&&Ie&&!Er&&(!qs(Q,r.dropTargetStyle)||!Ws(x,r.dropTargetClasses))&&($t([n],function(){return r.dropTargetStyle},function(){return x}),St([n],function(){return Q},function(){return x})),r.dropTargetStyle=Q,r.dropTargetClasses=ne(x);function M(ue,Rr){return U.get(ue)?U.get(ue)[Rr]:r[Rr]}t&&Ie&&r.dropFromOthersDisabled!==z&&(z?$t([n],function(ue){return M(ue,"dropTargetStyle")},function(ue){return M(ue,"dropTargetClasses")}):St([n],function(ue){return M(ue,"dropTargetStyle")},function(ue){return M(ue,"dropTargetClasses")})),r.dropFromOthersDisabled=z,U.set(n,r),gi(n,y);for(var ns=Vt(r.items),je=0;je<n.children.length;je++){var se=n.children[je];if(ai(se,w),je===ns){r.transformDraggedElement(G,K,je),I||oi(G,se,X.x,X.y),li(se);continue}se.removeEventListener("mousedown",Yt.get(se)),se.removeEventListener("touchstart",Yt.get(se)),w||(se.addEventListener("mousedown",u),se.addEventListener("touchstart",u),Yt.set(se,u)),s.set(se,je),t||(t=!0)}}return h(e),{update:function(f){h(f)},destroy:function(){function f(){zr(n,U.get(n).type),U.delete(n)}Ie&&!n.closest("[".concat(Gr,"]"))?_i(n,f):f()}}}var Et,lr={DND_ZONE_ACTIVE:"dnd-zone-active",DND_ZONE_DRAG_DISABLED:"dnd-zone-drag-disabled"},Gn=(Et={},Ze(Et,lr.DND_ZONE_ACTIVE,"Tab to one the items and press space-bar or enter to start dragging it"),Ze(Et,lr.DND_ZONE_DRAG_DISABLED,"This is a disabled drag and drop list"),Et),Ei="dnd-action-aria-alert",N;function cr(){N||(N=document.createElement("div"),function(){N.id=Ei,N.style.position="fixed",N.style.bottom="0",N.style.left="0",N.style.zIndex="-5",N.style.opacity="0",N.style.height="0",N.style.width="0",N.setAttribute("role","alert")}(),document.body.prepend(N),Object.entries(Gn).forEach(function(n){var e=Ts(n,2),t=e[0],r=e[1];return document.body.prepend(Oi(t,r))}))}function Ti(){return wr?null:(document.readyState==="complete"?cr():window.addEventListener("DOMContentLoaded",cr),xt({},lr))}function ki(){wr||!N||(Object.keys(Gn).forEach(function(n){var e;return(e=document.getElementById(n))===null||e===void 0?void 0:e.remove()}),N.remove(),N=void 0)}function Oi(n,e){var t=document.createElement("div");return t.id=n,t.innerHTML="<p>".concat(e,"</p>"),t.style.display="none",t.style.position="fixed",t.style.zIndex="-5",t}function He(n){if(!wr){N||cr(),N.innerHTML="";var e=document.createTextNode(n);N.appendChild(e),N.style.display="none",N.style.display="inline"}}var Si="--any--",Hr={outline:"rgba(255, 255, 102, 0.7) solid 2px"},re=!1,ur,W,Ce="",Ae,fe,ye="",Ut=new WeakSet,qr=new WeakMap,Wr=new WeakMap,hr=new Map,B=new Map,ae=new Map,Mt;function Ai(n,e){ae.size===0&&(Mt=Ti(),window.addEventListener("keydown",zn),window.addEventListener("click",Hn)),ae.has(e)||ae.set(e,new Set),ae.get(e).has(n)||(ae.get(e).add(n),Rn())}function Jr(n,e){W===n&&dt(),ae.get(e).delete(n),Cn(),ae.get(e).size===0&&ae.delete(e),ae.size===0&&(window.removeEventListener("keydown",zn),window.removeEventListener("click",Hn),Mt=void 0,ki())}function zn(n){if(re)switch(n.key){case"Escape":{dt();break}}}function Hn(){re&&(Ut.has(document.activeElement)||dt())}function Di(n){if(re){var e=n.currentTarget;if(e!==W){Ce=e.getAttribute("aria-label")||"";var t=B.get(W),r=t.items,s=r.find(function(h){return h[F]===fe}),i=r.indexOf(s),o=r.splice(i,1)[0],a=B.get(e),l=a.items,u=a.autoAriaDisabled;e.getBoundingClientRect().top<W.getBoundingClientRect().top||e.getBoundingClientRect().left<W.getBoundingClientRect().left?(l.push(o),u||He("Moved item ".concat(ye," to the end of the list ").concat(Ce))):(l.unshift(o),u||He("Moved item ".concat(ye," to the beginning of the list ").concat(Ce)));var c=W;Ye(c,r,{trigger:J.DROPPED_INTO_ANOTHER,id:fe,source:Z.KEYBOARD}),Ye(e,l,{trigger:J.DROPPED_INTO_ZONE,id:fe,source:Z.KEYBOARD}),W=e}}}function qn(){hr.forEach(function(n,e){var t=n.update;return t(B.get(e))})}function dt(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;B.get(W).autoAriaDisabled||He("Stopped dragging item ".concat(ye)),Ut.has(document.activeElement)&&document.activeElement.blur(),n&&be(W,B.get(W).items,{trigger:J.DRAG_STOPPED,id:fe,source:Z.KEYBOARD}),$t(ae.get(ur),function(e){return B.get(e).dropTargetStyle},function(e){return B.get(e).dropTargetClasses}),Ae=null,fe=null,ye="",ur=null,W=null,Ce="",re=!1,qn()}function Ii(n,e){var t={items:void 0,type:void 0,dragDisabled:!1,zoneTabIndex:0,zoneItemTabIndex:0,dropFromOthersDisabled:!1,dropTargetStyle:Hr,dropTargetClasses:[],autoAriaDisabled:!1};function r(c,h,d){c.length<=1||c.splice(d,1,c.splice(h,1,c[d])[0])}function s(c){switch(c.key){case"Enter":case" ":{if((c.target.disabled!==void 0||c.target.href||c.target.isContentEditable)&&!Ut.has(c.target))return;c.preventDefault(),c.stopPropagation(),re?dt():i(c);break}case"ArrowDown":case"ArrowRight":{if(!re)return;c.preventDefault(),c.stopPropagation();var h=B.get(n),d=h.items,f=Array.from(n.children),g=f.indexOf(c.currentTarget);g<f.length-1&&(t.autoAriaDisabled||He("Moved item ".concat(ye," to position ").concat(g+2," in the list ").concat(Ce)),r(d,g,g+1),Ye(n,d,{trigger:J.DROPPED_INTO_ZONE,id:fe,source:Z.KEYBOARD}));break}case"ArrowUp":case"ArrowLeft":{if(!re)return;c.preventDefault(),c.stopPropagation();var m=B.get(n),p=m.items,_=Array.from(n.children),y=_.indexOf(c.currentTarget);y>0&&(t.autoAriaDisabled||He("Moved item ".concat(ye," to position ").concat(y," in the list ").concat(Ce)),r(p,y,y-1),Ye(n,p,{trigger:J.DROPPED_INTO_ZONE,id:fe,source:Z.KEYBOARD}));break}}}function i(c){a(c.currentTarget),W=n,ur=t.type,re=!0;var h=Array.from(ae.get(t.type)).filter(function(f){return f===W||!B.get(f).dropFromOthersDisabled});if(St(h,function(f){return B.get(f).dropTargetStyle},function(f){return B.get(f).dropTargetClasses}),!t.autoAriaDisabled){var d="Started dragging item ".concat(ye,". Use the arrow keys to move it within its list ").concat(Ce);h.length>1&&(d+=", or tab to another list in order to move the item into it"),He(d)}be(n,B.get(n).items,{trigger:J.DRAG_STARTED,id:fe,source:Z.KEYBOARD}),qn()}function o(c){re&&c.currentTarget!==Ae&&(c.stopPropagation(),dt(!1),i(c))}function a(c){var h=B.get(n),d=h.items,f=Array.from(n.children),g=f.indexOf(c);Ae=c,Ae.tabIndex=t.zoneItemTabIndex,fe=d[g][F],ye=f[g].getAttribute("aria-label")||""}function l(c){var h=c.items,d=h===void 0?[]:h,f=c.type,g=f===void 0?Si:f,m=c.dragDisabled,p=m===void 0?!1:m,_=c.zoneTabIndex,y=_===void 0?0:_,T=c.zoneItemTabIndex,w=T===void 0?0:T,b=c.dropFromOthersDisabled,I=b===void 0?!1:b,A=c.dropTargetStyle,z=A===void 0?Hr:A,V=c.dropTargetClasses,Q=V===void 0?[]:V,ee=c.autoAriaDisabled,x=ee===void 0?!1:ee;t.items=ne(d),t.dragDisabled=p,t.dropFromOthersDisabled=I,t.zoneTabIndex=y,t.zoneItemTabIndex=w,t.dropTargetStyle=z,t.dropTargetClasses=Q,t.autoAriaDisabled=x,t.type&&g!==t.type&&Jr(n,t.type),t.type=g,Ai(n,g),x||(n.setAttribute("aria-disabled",p),n.setAttribute("role","list"),n.setAttribute("aria-describedby",p?Mt.DND_ZONE_DRAG_DISABLED:Mt.DND_ZONE_ACTIVE)),B.set(n,t),re?n.tabIndex=n===W||Ae.contains(n)||t.dropFromOthersDisabled||W&&t.type!==B.get(W).type?-1:0:n.tabIndex=t.zoneTabIndex,n.addEventListener("focus",Di);for(var P=function(Te){var M=n.children[Te];Ut.add(M),M.tabIndex=re?-1:t.zoneItemTabIndex,x||M.setAttribute("role","listitem"),M.removeEventListener("keydown",qr.get(M)),M.removeEventListener("click",Wr.get(M)),p||(M.addEventListener("keydown",s),qr.set(M,s),M.addEventListener("click",o),Wr.set(M,o)),re&&t.items[Te][F]===fe&&(Ae=M,Ae.tabIndex=t.zoneItemTabIndex,M.focus())},E=0;E<n.children.length;E++)P(E)}l(e);var u={update:function(h){l(h)},destroy:function(){Jr(n,t.type),B.delete(n),hr.delete(n)}};return hr.set(n,u),u}var Ri=["items","flipDurationMs","type","dragDisabled","morphDisabled","dropFromOthersDisabled","zoneTabIndex","zoneItemTabIndex","dropTargetStyle","dropTargetClasses","transformDraggedElement","autoAriaDisabled","centreDraggedOnCursor"];function Wn(n,e){if(Ci(n))return{update:function(){},destroy:function(){}};Vr(e);var t=bi(n,e),r=Ii(n,e);return{update:function(i){Vr(i),t.update(i),r.update(i)},destroy:function(){t.destroy(),r.destroy()}}}function Ci(n){return!!n.closest("[".concat(Ns,'="true"]'))}function Vr(n){var e=n.items;n.flipDurationMs,n.type,n.dragDisabled,n.morphDisabled,n.dropFromOthersDisabled;var t=n.zoneTabIndex,r=n.zoneItemTabIndex;n.dropTargetStyle;var s=n.dropTargetClasses;n.transformDraggedElement,n.autoAriaDisabled,n.centreDraggedOnCursor;var i=Es(n,Ri);if(Object.keys(i).length>0&&console.warn("dndzone will ignore unknown options",i),!e)throw new Error("no 'items' key provided to dndzone");var o=e.find(function(a){return!{}.hasOwnProperty.call(a,F)});if(o)throw new Error("missing '".concat(F,"' property for item ").concat(bt(o)));if(s&&!Array.isArray(s))throw new Error("dropTargetClasses should be an array but instead it is a ".concat(at(s),", ").concat(bt(s)));if(t&&!Kr(t))throw new Error("zoneTabIndex should be a number but instead it is a ".concat(at(t),", ").concat(bt(t)));if(r&&!Kr(r))throw new Error("zoneItemTabIndex should be a number but instead it is a ".concat(at(r),", ").concat(bt(r)))}function Kr(n){return!isNaN(n)&&function(e){return(e|0)===e}(parseFloat(n))}function Zr(n,{delay:e=0,duration:t=400,easing:r=wn}={}){const s=+getComputedStyle(n).opacity;return{delay:e,duration:t,easing:r,css:i=>`opacity: ${i*s}`}}function Pi(n){let e,t,r,s=n[0].intro.title+"",i,o,a,l=n[0].intro.dek+"",u,c,h,d=n[0].intro.button+"",f,g,m,p,_;return{c(){e=R("section"),t=R("div"),r=R("h1"),i=st(s),o=Pe(),a=R("h3"),u=st(l),c=Pe(),h=R("button"),f=st(d),this.h()},l(y){e=C(y,"SECTION",{});var T=de(e);t=C(T,"DIV",{class:!0});var w=de(t);r=C(w,"H1",{});var b=de(r);i=it(b,s),b.forEach(k),o=xe(w),a=C(w,"H3",{});var I=de(a);u=it(I,l),I.forEach(k),c=xe(w),h=C(w,"BUTTON",{class:!0});var A=de(h);f=it(A,d),A.forEach(k),w.forEach(k),T.forEach(k),this.h()},h(){v(h,"class","svelte-mlybgp"),v(t,"class","overlay svelte-mlybgp")},m(y,T){Ee(y,e,T),O(e,t),O(t,r),O(r,i),O(t,o),O(t,a),O(a,u),O(t,c),O(t,h),O(h,f),m=!0,p||(_=Je(h,"click",n[1]),p=!0)},p(y,[T]){(!m||T&1)&&s!==(s=y[0].intro.title+"")&&ot(i,s),(!m||T&1)&&l!==(l=y[0].intro.dek+"")&&ot(u,l),(!m||T&1)&&d!==(d=y[0].intro.button+"")&&ot(f,d)},i(y){m||(y&&os(()=>{m&&(g||(g=Lr(e,Zr,{},!0)),g.run(1))}),m=!0)},o(y){y&&(g||(g=Lr(e,Zr,{},!1)),g.run(0)),m=!1},d(y){y&&k(e),y&&g&&g.end(),p=!1,_()}}}function xi(n,e,t){let{copy:r}=e;const s=as();function i(){s("start",{started:!0})}return n.$$set=o=>{"copy"in o&&t(0,r=o.copy)},[r,i]}class Li extends mt{constructor(e){super(),pt(this,e,xi,Pi,gt,{copy:0})}}const ji={title:"Title TK",description:"Description tk."},$i={title:"What makes a K-pop Generation?",dek:"Take this survey to identify the different K-pop generations and we’ll tell you what kind of K-pop fan you are!",button:"Start"},Ni={clue:"Drag each group into an album"},Ui=[{type:"svelte",value:{component:"Example"}}],dr={meta:ji,intro:$i,board:Ni,body:Ui},Mi=n=>{let e;return n?e=n:typeof fetch>"u"?e=(...t)=>Ke(()=>Promise.resolve().then(()=>wt),void 0,import.meta.url).then(({default:r})=>r(...t)):e=fetch,(...t)=>e(...t)};class kr extends Error{constructor(e,t="FunctionsError",r){super(e),this.name=t,this.context=r}}class Fi extends kr{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class Bi extends kr{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class Gi extends kr{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var zi=function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function a(c){try{u(r.next(c))}catch(h){o(h)}}function l(c){try{u(r.throw(c))}catch(h){o(h)}}function u(c){c.done?i(c.value):s(c.value).then(a,l)}u((r=r.apply(n,e||[])).next())})};class Hi{constructor(e,{headers:t={},customFetch:r}={}){this.url=e,this.headers=t,this.fetch=Mi(r)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,t={}){var r;return zi(this,void 0,void 0,function*(){try{const{headers:s,method:i,body:o}=t;let a={},l;o&&(s&&!Object.prototype.hasOwnProperty.call(s,"Content-Type")||!s)&&(typeof Blob<"u"&&o instanceof Blob||o instanceof ArrayBuffer?(a["Content-Type"]="application/octet-stream",l=o):typeof o=="string"?(a["Content-Type"]="text/plain",l=o):typeof FormData<"u"&&o instanceof FormData?l=o:(a["Content-Type"]="application/json",l=JSON.stringify(o)));const u=yield this.fetch(`${this.url}/${e}`,{method:i||"POST",headers:Object.assign(Object.assign(Object.assign({},a),this.headers),s),body:l}).catch(f=>{throw new Fi(f)}),c=u.headers.get("x-relay-error");if(c&&c==="true")throw new Bi(u);if(!u.ok)throw new Gi(u);let h=((r=u.headers.get("Content-Type"))!==null&&r!==void 0?r:"text/plain").split(";")[0].trim(),d;return h==="application/json"?d=yield u.json():h==="application/octet-stream"?d=yield u.blob():h==="multipart/form-data"?d=yield u.formData():d=yield u.text(),{data:d,error:null}}catch(s){return{data:null,error:s}}})}}var qi=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},Qe=qi();const Wi=Qe.fetch,Or=Qe.fetch.bind(Qe),Jn=Qe.Headers,Ji=Qe.Request,Vi=Qe.Response,wt=Object.freeze(Object.defineProperty({__proto__:null,Headers:Jn,Request:Ji,Response:Vi,default:Or,fetch:Wi},Symbol.toStringTag,{value:"Module"}));class Ki extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}}class Zi{constructor(e){this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=e.headers,this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=e.shouldThrowOnError,this.signal=e.signal,this.isMaybeSingle=e.isMaybeSingle,e.fetch?this.fetch=e.fetch:typeof fetch>"u"?this.fetch=Or:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}then(e,t){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const r=this.fetch;let s=r(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async i=>{var o,a,l;let u=null,c=null,h=null,d=i.status,f=i.statusText;if(i.ok){if(this.method!=="HEAD"){const _=await i.text();_===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?c=_:c=JSON.parse(_))}const m=(o=this.headers.Prefer)===null||o===void 0?void 0:o.match(/count=(exact|planned|estimated)/),p=(a=i.headers.get("content-range"))===null||a===void 0?void 0:a.split("/");m&&p&&p.length>1&&(h=parseInt(p[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(c)&&(c.length>1?(u={code:"PGRST116",details:`Results contain ${c.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},c=null,h=null,d=406,f="Not Acceptable"):c.length===1?c=c[0]:c=null)}else{const m=await i.text();try{u=JSON.parse(m),Array.isArray(u)&&i.status===404&&(c=[],u=null,d=200,f="OK")}catch{i.status===404&&m===""?(d=204,f="No Content"):u={message:m}}if(u&&this.isMaybeSingle&&(!((l=u==null?void 0:u.details)===null||l===void 0)&&l.includes("0 rows"))&&(u=null,d=200,f="OK"),u&&this.shouldThrowOnError)throw new Ki(u)}return{error:u,data:c,count:h,status:d,statusText:f}});return this.shouldThrowOnError||(s=s.catch(i=>{var o,a,l;return{error:{message:`${(o=i==null?void 0:i.name)!==null&&o!==void 0?o:"FetchError"}: ${i==null?void 0:i.message}`,details:`${(a=i==null?void 0:i.stack)!==null&&a!==void 0?a:""}`,hint:"",code:`${(l=i==null?void 0:i.code)!==null&&l!==void 0?l:""}`},data:null,count:null,status:0,statusText:""}})),s.then(e,t)}}class Yi extends Zi{select(e){let t=!1;const r=(e??"*").split("").map(s=>/\s/.test(s)&&!t?"":(s==='"'&&(t=!t),s)).join("");return this.url.searchParams.set("select",r),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(e,{ascending:t=!0,nullsFirst:r,foreignTable:s,referencedTable:i=s}={}){const o=i?`${i}.order`:"order",a=this.url.searchParams.get(o);return this.url.searchParams.set(o,`${a?`${a},`:""}${e}.${t?"asc":"desc"}${r===void 0?"":r?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:t,referencedTable:r=t}={}){const s=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(s,`${e}`),this}range(e,t,{foreignTable:r,referencedTable:s=r}={}){const i=typeof s>"u"?"offset":`${s}.offset`,o=typeof s>"u"?"limit":`${s}.limit`;return this.url.searchParams.set(i,`${e}`),this.url.searchParams.set(o,`${t-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:e=!1,verbose:t=!1,settings:r=!1,buffers:s=!1,wal:i=!1,format:o="text"}={}){var a;const l=[e?"analyze":null,t?"verbose":null,r?"settings":null,s?"buffers":null,i?"wal":null].filter(Boolean).join("|"),u=(a=this.headers.Accept)!==null&&a!==void 0?a:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${o}; for="${u}"; options=${l};`,o==="json"?this:this}rollback(){var e;return((e=this.headers.Prefer)!==null&&e!==void 0?e:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}}class Be extends Yi{eq(e,t){return this.url.searchParams.append(e,`eq.${t}`),this}neq(e,t){return this.url.searchParams.append(e,`neq.${t}`),this}gt(e,t){return this.url.searchParams.append(e,`gt.${t}`),this}gte(e,t){return this.url.searchParams.append(e,`gte.${t}`),this}lt(e,t){return this.url.searchParams.append(e,`lt.${t}`),this}lte(e,t){return this.url.searchParams.append(e,`lte.${t}`),this}like(e,t){return this.url.searchParams.append(e,`like.${t}`),this}likeAllOf(e,t){return this.url.searchParams.append(e,`like(all).{${t.join(",")}}`),this}likeAnyOf(e,t){return this.url.searchParams.append(e,`like(any).{${t.join(",")}}`),this}ilike(e,t){return this.url.searchParams.append(e,`ilike.${t}`),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,`ilike(any).{${t.join(",")}}`),this}is(e,t){return this.url.searchParams.append(e,`is.${t}`),this}in(e,t){const r=t.map(s=>typeof s=="string"&&new RegExp("[,()]").test(s)?`"${s}"`:`${s}`).join(",");return this.url.searchParams.append(e,`in.(${r})`),this}contains(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cs.{${t.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(t)}`),this}containedBy(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cd.{${t.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(t)}`),this}rangeGt(e,t){return this.url.searchParams.append(e,`sr.${t}`),this}rangeGte(e,t){return this.url.searchParams.append(e,`nxl.${t}`),this}rangeLt(e,t){return this.url.searchParams.append(e,`sl.${t}`),this}rangeLte(e,t){return this.url.searchParams.append(e,`nxr.${t}`),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,`adj.${t}`),this}overlaps(e,t){return typeof t=="string"?this.url.searchParams.append(e,`ov.${t}`):this.url.searchParams.append(e,`ov.{${t.join(",")}}`),this}textSearch(e,t,{config:r,type:s}={}){let i="";s==="plain"?i="pl":s==="phrase"?i="ph":s==="websearch"&&(i="w");const o=r===void 0?"":`(${r})`;return this.url.searchParams.append(e,`${i}fts${o}.${t}`),this}match(e){return Object.entries(e).forEach(([t,r])=>{this.url.searchParams.append(t,`eq.${r}`)}),this}not(e,t,r){return this.url.searchParams.append(e,`not.${t}.${r}`),this}or(e,{foreignTable:t,referencedTable:r=t}={}){const s=r?`${r}.or`:"or";return this.url.searchParams.append(s,`(${e})`),this}filter(e,t,r){return this.url.searchParams.append(e,`${t}.${r}`),this}}class Xi{constructor(e,{headers:t={},schema:r,fetch:s}){this.url=e,this.headers=t,this.schema=r,this.fetch=s}select(e,{head:t=!1,count:r}={}){const s=t?"HEAD":"GET";let i=!1;const o=(e??"*").split("").map(a=>/\s/.test(a)&&!i?"":(a==='"'&&(i=!i),a)).join("");return this.url.searchParams.set("select",o),r&&(this.headers.Prefer=`count=${r}`),new Be({method:s,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(e,{count:t,defaultToNull:r=!0}={}){const s="POST",i=[];if(this.headers.Prefer&&i.push(this.headers.Prefer),t&&i.push(`count=${t}`),r||i.push("missing=default"),this.headers.Prefer=i.join(","),Array.isArray(e)){const o=e.reduce((a,l)=>a.concat(Object.keys(l)),[]);if(o.length>0){const a=[...new Set(o)].map(l=>`"${l}"`);this.url.searchParams.set("columns",a.join(","))}}return new Be({method:s,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}upsert(e,{onConflict:t,ignoreDuplicates:r=!1,count:s,defaultToNull:i=!0}={}){const o="POST",a=[`resolution=${r?"ignore":"merge"}-duplicates`];if(t!==void 0&&this.url.searchParams.set("on_conflict",t),this.headers.Prefer&&a.push(this.headers.Prefer),s&&a.push(`count=${s}`),i||a.push("missing=default"),this.headers.Prefer=a.join(","),Array.isArray(e)){const l=e.reduce((u,c)=>u.concat(Object.keys(c)),[]);if(l.length>0){const u=[...new Set(l)].map(c=>`"${c}"`);this.url.searchParams.set("columns",u.join(","))}}return new Be({method:o,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}update(e,{count:t}={}){const r="PATCH",s=[];return this.headers.Prefer&&s.push(this.headers.Prefer),t&&s.push(`count=${t}`),this.headers.Prefer=s.join(","),new Be({method:r,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}delete({count:e}={}){const t="DELETE",r=[];return e&&r.push(`count=${e}`),this.headers.Prefer&&r.unshift(this.headers.Prefer),this.headers.Prefer=r.join(","),new Be({method:t,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}}const Qi="1.9.2",eo={"X-Client-Info":`postgrest-js/${Qi}`};class Sr{constructor(e,{headers:t={},schema:r,fetch:s}={}){this.url=e,this.headers=Object.assign(Object.assign({},eo),t),this.schemaName=r,this.fetch=s}from(e){const t=new URL(`${this.url}/${e}`);return new Xi(t,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new Sr(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,t={},{head:r=!1,count:s}={}){let i;const o=new URL(`${this.url}/rpc/${e}`);let a;r?(i="HEAD",Object.entries(t).forEach(([u,c])=>{o.searchParams.append(u,`${c}`)})):(i="POST",a=t);const l=Object.assign({},this.headers);return s&&(l.Prefer=`count=${s}`),new Be({method:i,url:o,headers:l,schema:this.schemaName,body:a,fetch:this.fetch,allowEmpty:!1})}}const to="2.9.3",ro={"X-Client-Info":`realtime-js/${to}`},no="1.0.0",Vn=1e4,so=1e3;var qe;(function(n){n[n.connecting=0]="connecting",n[n.open=1]="open",n[n.closing=2]="closing",n[n.closed=3]="closed"})(qe||(qe={}));var Y;(function(n){n.closed="closed",n.errored="errored",n.joined="joined",n.joining="joining",n.leaving="leaving"})(Y||(Y={}));var oe;(function(n){n.close="phx_close",n.error="phx_error",n.join="phx_join",n.reply="phx_reply",n.leave="phx_leave",n.access_token="access_token"})(oe||(oe={}));var fr;(function(n){n.websocket="websocket"})(fr||(fr={}));var Re;(function(n){n.Connecting="connecting",n.Open="open",n.Closing="closing",n.Closed="closed"})(Re||(Re={}));class Kn{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}class io{constructor(){this.HEADER_LENGTH=1}decode(e,t){return e.constructor===ArrayBuffer?t(this._binaryDecode(e)):t(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const t=new DataView(e),r=new TextDecoder;return this._decodeBroadcast(e,t,r)}_decodeBroadcast(e,t,r){const s=t.getUint8(1),i=t.getUint8(2);let o=this.HEADER_LENGTH+2;const a=r.decode(e.slice(o,o+s));o=o+s;const l=r.decode(e.slice(o,o+i));o=o+i;const u=JSON.parse(r.decode(e.slice(o,e.byteLength)));return{ref:null,topic:a,event:l,payload:u}}}class Xt{constructor(e,t,r={},s=Vn){this.channel=e,this.event=t,this.payload=r,this.timeout=s,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var r;return this._hasReceived(e)&&t((r=this.receivedResp)===null||r===void 0?void 0:r.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=t=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=t,this._matchReceive(t)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(r=>r.status===e).forEach(r=>r.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var Yr;(function(n){n.SYNC="sync",n.JOIN="join",n.LEAVE="leave"})(Yr||(Yr={}));class lt{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const r=(t==null?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},s=>{const{onJoin:i,onLeave:o,onSync:a}=this.caller;this.joinRef=this.channel._joinRef(),this.state=lt.syncState(this.state,s,i,o),this.pendingDiffs.forEach(l=>{this.state=lt.syncDiff(this.state,l,i,o)}),this.pendingDiffs=[],a()}),this.channel._on(r.diff,{},s=>{const{onJoin:i,onLeave:o,onSync:a}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(s):(this.state=lt.syncDiff(this.state,s,i,o),a())}),this.onJoin((s,i,o)=>{this.channel._trigger("presence",{event:"join",key:s,currentPresences:i,newPresences:o})}),this.onLeave((s,i,o)=>{this.channel._trigger("presence",{event:"leave",key:s,currentPresences:i,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,r,s){const i=this.cloneDeep(e),o=this.transformState(t),a={},l={};return this.map(i,(u,c)=>{o[u]||(l[u]=c)}),this.map(o,(u,c)=>{const h=i[u];if(h){const d=c.map(p=>p.presence_ref),f=h.map(p=>p.presence_ref),g=c.filter(p=>f.indexOf(p.presence_ref)<0),m=h.filter(p=>d.indexOf(p.presence_ref)<0);g.length>0&&(a[u]=g),m.length>0&&(l[u]=m)}else a[u]=c}),this.syncDiff(i,{joins:a,leaves:l},r,s)}static syncDiff(e,t,r,s){const{joins:i,leaves:o}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return r||(r=()=>{}),s||(s=()=>{}),this.map(i,(a,l)=>{var u;const c=(u=e[a])!==null&&u!==void 0?u:[];if(e[a]=this.cloneDeep(l),c.length>0){const h=e[a].map(f=>f.presence_ref),d=c.filter(f=>h.indexOf(f.presence_ref)<0);e[a].unshift(...d)}r(a,c,l)}),this.map(o,(a,l)=>{let u=e[a];if(!u)return;const c=l.map(h=>h.presence_ref);u=u.filter(h=>c.indexOf(h.presence_ref)<0),e[a]=u,s(a,u,l),u.length===0&&delete e[a]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(r=>t(r,e[r]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,r)=>{const s=e[r];return"metas"in s?t[r]=s.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):t[r]=s,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var L;(function(n){n.abstime="abstime",n.bool="bool",n.date="date",n.daterange="daterange",n.float4="float4",n.float8="float8",n.int2="int2",n.int4="int4",n.int4range="int4range",n.int8="int8",n.int8range="int8range",n.json="json",n.jsonb="jsonb",n.money="money",n.numeric="numeric",n.oid="oid",n.reltime="reltime",n.text="text",n.time="time",n.timestamp="timestamp",n.timestamptz="timestamptz",n.timetz="timetz",n.tsrange="tsrange",n.tstzrange="tstzrange"})(L||(L={}));const Xr=(n,e,t={})=>{var r;const s=(r=t.skipTypes)!==null&&r!==void 0?r:[];return Object.keys(e).reduce((i,o)=>(i[o]=oo(o,n,e,s),i),{})},oo=(n,e,t,r)=>{const s=e.find(a=>a.name===n),i=s==null?void 0:s.type,o=t[n];return i&&!r.includes(i)?Zn(i,o):gr(o)},Zn=(n,e)=>{if(n.charAt(0)==="_"){const t=n.slice(1,n.length);return uo(e,t)}switch(n){case L.bool:return ao(e);case L.float4:case L.float8:case L.int2:case L.int4:case L.int8:case L.numeric:case L.oid:return lo(e);case L.json:case L.jsonb:return co(e);case L.timestamp:return ho(e);case L.abstime:case L.date:case L.daterange:case L.int4range:case L.int8range:case L.money:case L.reltime:case L.text:case L.time:case L.timestamptz:case L.timetz:case L.tsrange:case L.tstzrange:return gr(e);default:return gr(e)}},gr=n=>n,ao=n=>{switch(n){case"t":return!0;case"f":return!1;default:return n}},lo=n=>{if(typeof n=="string"){const e=parseFloat(n);if(!Number.isNaN(e))return e}return n},co=n=>{if(typeof n=="string")try{return JSON.parse(n)}catch(e){return console.log(`JSON parse error: ${e}`),n}return n},uo=(n,e)=>{if(typeof n!="string")return n;const t=n.length-1,r=n[t];if(n[0]==="{"&&r==="}"){let i;const o=n.slice(1,t);try{i=JSON.parse("["+o+"]")}catch{i=o?o.split(","):[]}return i.map(a=>Zn(e,a))}return n},ho=n=>typeof n=="string"?n.replace(" ","T"):n;var Qr;(function(n){n.ALL="*",n.INSERT="INSERT",n.UPDATE="UPDATE",n.DELETE="DELETE"})(Qr||(Qr={}));var en;(function(n){n.BROADCAST="broadcast",n.PRESENCE="presence",n.POSTGRES_CHANGES="postgres_changes"})(en||(en={}));var tn;(function(n){n.SUBSCRIBED="SUBSCRIBED",n.TIMED_OUT="TIMED_OUT",n.CLOSED="CLOSED",n.CHANNEL_ERROR="CHANNEL_ERROR"})(tn||(tn={}));class Ar{constructor(e,t={config:{}},r){this.topic=e,this.params=t,this.socket=r,this.bindings={},this.state=Y.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""}},t.config),this.timeout=this.socket.timeout,this.joinPush=new Xt(this,oe.join,this.params,this.timeout),this.rejoinTimer=new Kn(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Y.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(s=>s.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Y.closed,this.socket._remove(this)}),this._onError(s=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,s),this.state=Y.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Y.errored,this.rejoinTimer.scheduleTimeout())}),this._on(oe.reply,{},(s,i)=>{this._trigger(this._replyEventName(i),s)}),this.presence=new lt(this),this.broadcastEndpointURL=this._broadcastEndpointURL()}subscribe(e,t=this.timeout){var r,s;if(this.socket.isConnected()||this.socket.connect(),this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{const{config:{broadcast:i,presence:o}}=this.params;this._onError(u=>e&&e("CHANNEL_ERROR",u)),this._onClose(()=>e&&e("CLOSED"));const a={},l={broadcast:i,presence:o,postgres_changes:(s=(r=this.bindings.postgres_changes)===null||r===void 0?void 0:r.map(u=>u.filter))!==null&&s!==void 0?s:[]};this.socket.accessToken&&(a.access_token=this.socket.accessToken),this.updateJoinPayload(Object.assign({config:l},a)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",({postgres_changes:u})=>{var c;if(this.socket.accessToken&&this.socket.setAuth(this.socket.accessToken),u===void 0){e&&e("SUBSCRIBED");return}else{const h=this.bindings.postgres_changes,d=(c=h==null?void 0:h.length)!==null&&c!==void 0?c:0,f=[];for(let g=0;g<d;g++){const m=h[g],{filter:{event:p,schema:_,table:y,filter:T}}=m,w=u&&u[g];if(w&&w.event===p&&w.schema===_&&w.table===y&&w.filter===T)f.push(Object.assign(Object.assign({},m),{id:w.id}));else{this.unsubscribe(),e&&e("CHANNEL_ERROR",new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=f,e&&e("SUBSCRIBED");return}}).receive("error",u=>{e&&e("CHANNEL_ERROR",new Error(JSON.stringify(Object.values(u).join(", ")||"error")))}).receive("timeout",()=>{e&&e("TIMED_OUT")})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,r){return this._on(e,t,r)}async send(e,t={}){var r,s;if(!this._canPush()&&e.type==="broadcast"){const{event:i,payload:o}=e,a={method:"POST",headers:{apikey:(r=this.socket.apiKey)!==null&&r!==void 0?r:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:o}]})};try{return(await this._fetchWithTimeout(this.broadcastEndpointURL,a,(s=t.timeout)!==null&&s!==void 0?s:this.timeout)).ok?"ok":"error"}catch(l){return l.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var o,a,l;const u=this._push(e.type,e,t.timeout||this.timeout);e.type==="broadcast"&&!(!((l=(a=(o=this.params)===null||o===void 0?void 0:o.config)===null||a===void 0?void 0:a.broadcast)===null||l===void 0)&&l.ack)&&i("ok"),u.receive("ok",()=>i("ok")),u.receive("timeout",()=>i("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=Y.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(oe.close,"leave",this._joinRef())};return this.rejoinTimer.reset(),this.joinPush.destroy(),new Promise(r=>{const s=new Xt(this,oe.leave,{},e);s.receive("ok",()=>{t(),r("ok")}).receive("timeout",()=>{t(),r("timed out")}).receive("error",()=>{r("error")}),s.send(),this._canPush()||s.trigger("ok",{})})}_broadcastEndpointURL(){let e=this.socket.endPoint;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")+"/api/broadcast"}async _fetchWithTimeout(e,t,r){const s=new AbortController,i=setTimeout(()=>s.abort(),r),o=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:s.signal}));return clearTimeout(i),o}_push(e,t,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let s=new Xt(this,e,t,r);return this._canPush()?s.send():(s.startTimeout(),this.pushBuffer.push(s)),s}_onMessage(e,t,r){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,r){var s,i;const o=e.toLocaleLowerCase(),{close:a,error:l,leave:u,join:c}=oe;if(r&&[a,l,u,c].indexOf(o)>=0&&r!==this._joinRef())return;let d=this._onMessage(o,t,r);if(t&&!d)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(s=this.bindings.postgres_changes)===null||s===void 0||s.filter(f=>{var g,m,p;return((g=f.filter)===null||g===void 0?void 0:g.event)==="*"||((p=(m=f.filter)===null||m===void 0?void 0:m.event)===null||p===void 0?void 0:p.toLocaleLowerCase())===o}).map(f=>f.callback(d,r)):(i=this.bindings[o])===null||i===void 0||i.filter(f=>{var g,m,p,_,y,T;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in f){const w=f.id,b=(g=f.filter)===null||g===void 0?void 0:g.event;return w&&((m=t.ids)===null||m===void 0?void 0:m.includes(w))&&(b==="*"||(b==null?void 0:b.toLocaleLowerCase())===((p=t.data)===null||p===void 0?void 0:p.type.toLocaleLowerCase()))}else{const w=(y=(_=f==null?void 0:f.filter)===null||_===void 0?void 0:_.event)===null||y===void 0?void 0:y.toLocaleLowerCase();return w==="*"||w===((T=t==null?void 0:t.event)===null||T===void 0?void 0:T.toLocaleLowerCase())}else return f.type.toLocaleLowerCase()===o}).map(f=>{if(typeof d=="object"&&"ids"in d){const g=d.data,{schema:m,table:p,commit_timestamp:_,type:y,errors:T}=g;d=Object.assign(Object.assign({},{schema:m,table:p,commit_timestamp:_,eventType:y,new:{},old:{},errors:T}),this._getPayloadRecords(g))}f.callback(d,r)})}_isClosed(){return this.state===Y.closed}_isJoined(){return this.state===Y.joined}_isJoining(){return this.state===Y.joining}_isLeaving(){return this.state===Y.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,r){const s=e.toLocaleLowerCase(),i={type:s,filter:t,callback:r};return this.bindings[s]?this.bindings[s].push(i):this.bindings[s]=[i],this}_off(e,t){const r=e.toLocaleLowerCase();return this.bindings[r]=this.bindings[r].filter(s=>{var i;return!(((i=s.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===r&&Ar.isEqual(s.filter,t))}),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const r in e)if(e[r]!==t[r])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(oe.close,{},e)}_onError(e){this._on(oe.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Y.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(t.new=Xr(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(t.old=Xr(e.columns,e.old_record)),t}}const fo=()=>{},go=typeof WebSocket<"u";class mo{constructor(e,t){var r;this.accessToken=null,this.apiKey=null,this.channels=[],this.endPoint="",this.headers=ro,this.params={},this.timeout=Vn,this.heartbeatIntervalMs=3e4,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.ref=0,this.logger=fo,this.conn=null,this.sendBuffer=[],this.serializer=new io,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this._resolveFetch=i=>{let o;return i?o=i:typeof fetch>"u"?o=(...a)=>Ke(()=>Promise.resolve().then(()=>wt),void 0,import.meta.url).then(({default:l})=>l(...a)):o=fetch,(...a)=>o(...a)},this.endPoint=`${e}/${fr.websocket}`,t!=null&&t.transport?this.transport=t.transport:this.transport=null,t!=null&&t.params&&(this.params=t.params),t!=null&&t.headers&&(this.headers=Object.assign(Object.assign({},this.headers),t.headers)),t!=null&&t.timeout&&(this.timeout=t.timeout),t!=null&&t.logger&&(this.logger=t.logger),t!=null&&t.heartbeatIntervalMs&&(this.heartbeatIntervalMs=t.heartbeatIntervalMs);const s=(r=t==null?void 0:t.params)===null||r===void 0?void 0:r.apikey;s&&(this.accessToken=s,this.apiKey=s),this.reconnectAfterMs=t!=null&&t.reconnectAfterMs?t.reconnectAfterMs:i=>[1e3,2e3,5e3,1e4][i-1]||1e4,this.encode=t!=null&&t.encode?t.encode:(i,o)=>o(JSON.stringify(i)),this.decode=t!=null&&t.decode?t.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new Kn(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(t==null?void 0:t.fetch)}connect(){if(!this.conn){if(this.transport){this.conn=new this.transport(this._endPointURL(),void 0,{headers:this.headers});return}if(go){this.conn=new WebSocket(this._endPointURL()),this.setupConnection();return}this.conn=new po(this._endPointURL(),void 0,{close:()=>{this.conn=null}}),Ke(()=>import("../chunks/browser.Dyv4tp0p.js").then(e=>e.b),__vite__mapDeps([0,1,2,3]),import.meta.url).then(({default:e})=>{this.conn=new e(this._endPointURL(),void 0,{headers:this.headers}),this.setupConnection()})}}disconnect(e,t){this.conn&&(this.conn.onclose=function(){},e?this.conn.close(e,t??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset())}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map(t=>t.unsubscribe()));return this.disconnect(),e}log(e,t,r){this.logger(e,t,r)}connectionState(){switch(this.conn&&this.conn.readyState){case qe.connecting:return Re.Connecting;case qe.open:return Re.Open;case qe.closing:return Re.Closing;default:return Re.Closed}}isConnected(){return this.connectionState()===Re.Open}channel(e,t={config:{}}){const r=new Ar(`realtime:${e}`,t,this);return this.channels.push(r),r}push(e){const{topic:t,event:r,payload:s,ref:i}=e,o=()=>{this.encode(e,a=>{var l;(l=this.conn)===null||l===void 0||l.send(a)})};this.log("push",`${t} ${r} (${i})`,s),this.isConnected()?o():this.sendBuffer.push(o)}setAuth(e){this.accessToken=e,this.channels.forEach(t=>{e&&t.updateJoinPayload({access_token:e}),t.joinedOnce&&t._isJoined()&&t._push(oe.access_token,{access_token:e})})}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(r=>r.topic===e&&(r._isJoined()||r._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t._joinRef()!==e._joinRef())}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_endPointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:no}))}_onConnMessage(e){this.decode(e.data,t=>{let{topic:r,event:s,payload:i,ref:o}=t;(o&&o===this.pendingHeartbeatRef||s===(i==null?void 0:i.type))&&(this.pendingHeartbeatRef=null),this.log("receive",`${i.status||""} ${r} ${s} ${o&&"("+o+")"||""}`,i),this.channels.filter(a=>a._isMember(r)).forEach(a=>a._trigger(s,i,o)),this.stateChangeCallbacks.message.forEach(a=>a(t))})}_onConnOpen(){this.log("transport",`connected to ${this._endPointURL()}`),this._flushSendBuffer(),this.reconnectTimer.reset(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this._sendHeartbeat(),this.heartbeatIntervalMs),this.stateChangeCallbacks.open.forEach(e=>e())}_onConnClose(e){this.log("transport","close",e),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(t=>t(e))}_onConnError(e){this.log("transport",e.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(t=>t(e))}_triggerChanError(){this.channels.forEach(e=>e._trigger(oe.error))}_appendParams(e,t){if(Object.keys(t).length===0)return e;const r=e.match(/\?/)?"&":"?",s=new URLSearchParams(t);return`${e}${r}${s}`}_flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_sendHeartbeat(){var e;if(this.isConnected()){if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),(e=this.conn)===null||e===void 0||e.close(so,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.setAuth(this.accessToken)}}}class po{constructor(e,t,r){this.binaryType="arraybuffer",this.onclose=()=>{},this.onerror=()=>{},this.onmessage=()=>{},this.onopen=()=>{},this.readyState=qe.connecting,this.send=()=>{},this.url=null,this.url=e,this.close=r.close}}class Dr extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function H(n){return typeof n=="object"&&n!==null&&"__isStorageError"in n}class vo extends Dr{constructor(e,t){super(e),this.name="StorageApiError",this.status=t}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class rn extends Dr{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}var yo=function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function a(c){try{u(r.next(c))}catch(h){o(h)}}function l(c){try{u(r.throw(c))}catch(h){o(h)}}function u(c){c.done?i(c.value):s(c.value).then(a,l)}u((r=r.apply(n,e||[])).next())})};const Yn=n=>{let e;return n?e=n:typeof fetch>"u"?e=(...t)=>Ke(()=>Promise.resolve().then(()=>wt),void 0,import.meta.url).then(({default:r})=>r(...t)):e=fetch,(...t)=>e(...t)},_o=()=>yo(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield Ke(()=>Promise.resolve().then(()=>wt),void 0,import.meta.url)).Response:Response});var et=function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function a(c){try{u(r.next(c))}catch(h){o(h)}}function l(c){try{u(r.throw(c))}catch(h){o(h)}}function u(c){c.done?i(c.value):s(c.value).then(a,l)}u((r=r.apply(n,e||[])).next())})};const Qt=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),wo=(n,e)=>et(void 0,void 0,void 0,function*(){const t=yield _o();n instanceof t?n.json().then(r=>{e(new vo(Qt(r),n.status||500))}).catch(r=>{e(new rn(Qt(r),r))}):e(new rn(Qt(n),n))}),bo=(n,e,t,r)=>{const s={method:n,headers:(e==null?void 0:e.headers)||{}};return n==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),s.body=JSON.stringify(r),Object.assign(Object.assign({},s),t))};function Kt(n,e,t,r,s,i){return et(this,void 0,void 0,function*(){return new Promise((o,a)=>{n(t,bo(e,r,s,i)).then(l=>{if(!l.ok)throw l;return r!=null&&r.noResolveJson?l:l.json()}).then(l=>o(l)).catch(l=>wo(l,a))})})}function mr(n,e,t,r){return et(this,void 0,void 0,function*(){return Kt(n,"GET",e,t,r)})}function me(n,e,t,r,s){return et(this,void 0,void 0,function*(){return Kt(n,"POST",e,r,s,t)})}function Eo(n,e,t,r,s){return et(this,void 0,void 0,function*(){return Kt(n,"PUT",e,r,s,t)})}function Xn(n,e,t,r,s){return et(this,void 0,void 0,function*(){return Kt(n,"DELETE",e,r,s,t)})}var te=function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function a(c){try{u(r.next(c))}catch(h){o(h)}}function l(c){try{u(r.throw(c))}catch(h){o(h)}}function u(c){c.done?i(c.value):s(c.value).then(a,l)}u((r=r.apply(n,e||[])).next())})};const To={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},nn={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class ko{constructor(e,t={},r,s){this.url=e,this.headers=t,this.bucketId=r,this.fetch=Yn(s)}uploadOrUpdate(e,t,r,s){return te(this,void 0,void 0,function*(){try{let i;const o=Object.assign(Object.assign({},nn),s),a=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(o.upsert)});typeof Blob<"u"&&r instanceof Blob?(i=new FormData,i.append("cacheControl",o.cacheControl),i.append("",r)):typeof FormData<"u"&&r instanceof FormData?(i=r,i.append("cacheControl",o.cacheControl)):(i=r,a["cache-control"]=`max-age=${o.cacheControl}`,a["content-type"]=o.contentType);const l=this._removeEmptyFolders(t),u=this._getFinalPath(l),c=yield this.fetch(`${this.url}/object/${u}`,Object.assign({method:e,body:i,headers:a},o!=null&&o.duplex?{duplex:o.duplex}:{})),h=yield c.json();return c.ok?{data:{path:l,id:h.Id,fullPath:h.Key},error:null}:{data:null,error:h}}catch(i){if(H(i))return{data:null,error:i};throw i}})}upload(e,t,r){return te(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,t,r)})}uploadToSignedUrl(e,t,r,s){return te(this,void 0,void 0,function*(){const i=this._removeEmptyFolders(e),o=this._getFinalPath(i),a=new URL(this.url+`/object/upload/sign/${o}`);a.searchParams.set("token",t);try{let l;const u=Object.assign({upsert:nn.upsert},s),c=Object.assign(Object.assign({},this.headers),{"x-upsert":String(u.upsert)});typeof Blob<"u"&&r instanceof Blob?(l=new FormData,l.append("cacheControl",u.cacheControl),l.append("",r)):typeof FormData<"u"&&r instanceof FormData?(l=r,l.append("cacheControl",u.cacheControl)):(l=r,c["cache-control"]=`max-age=${u.cacheControl}`,c["content-type"]=u.contentType);const h=yield this.fetch(a.toString(),{method:"PUT",body:l,headers:c}),d=yield h.json();return h.ok?{data:{path:i,fullPath:d.Key},error:null}:{data:null,error:d}}catch(l){if(H(l))return{data:null,error:l};throw l}})}createSignedUploadUrl(e){return te(this,void 0,void 0,function*(){try{let t=this._getFinalPath(e);const r=yield me(this.fetch,`${this.url}/object/upload/sign/${t}`,{},{headers:this.headers}),s=new URL(this.url+r.url),i=s.searchParams.get("token");if(!i)throw new Dr("No token returned by API");return{data:{signedUrl:s.toString(),path:e,token:i},error:null}}catch(t){if(H(t))return{data:null,error:t};throw t}})}update(e,t,r){return te(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,t,r)})}move(e,t){return te(this,void 0,void 0,function*(){try{return{data:yield me(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t},{headers:this.headers}),error:null}}catch(r){if(H(r))return{data:null,error:r};throw r}})}copy(e,t){return te(this,void 0,void 0,function*(){try{return{data:{path:(yield me(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t},{headers:this.headers})).Key},error:null}}catch(r){if(H(r))return{data:null,error:r};throw r}})}createSignedUrl(e,t,r){return te(this,void 0,void 0,function*(){try{let s=this._getFinalPath(e),i=yield me(this.fetch,`${this.url}/object/sign/${s}`,Object.assign({expiresIn:t},r!=null&&r.transform?{transform:r.transform}:{}),{headers:this.headers});const o=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return i={signedUrl:encodeURI(`${this.url}${i.signedURL}${o}`)},{data:i,error:null}}catch(s){if(H(s))return{data:null,error:s};throw s}})}createSignedUrls(e,t,r){return te(this,void 0,void 0,function*(){try{const s=yield me(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:e},{headers:this.headers}),i=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return{data:s.map(o=>Object.assign(Object.assign({},o),{signedUrl:o.signedURL?encodeURI(`${this.url}${o.signedURL}${i}`):null})),error:null}}catch(s){if(H(s))return{data:null,error:s};throw s}})}download(e,t){return te(this,void 0,void 0,function*(){const s=typeof(t==null?void 0:t.transform)<"u"?"render/image/authenticated":"object",i=this.transformOptsToQueryString((t==null?void 0:t.transform)||{}),o=i?`?${i}`:"";try{const a=this._getFinalPath(e);return{data:yield(yield mr(this.fetch,`${this.url}/${s}/${a}${o}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(a){if(H(a))return{data:null,error:a};throw a}})}getPublicUrl(e,t){const r=this._getFinalPath(e),s=[],i=t!=null&&t.download?`download=${t.download===!0?"":t.download}`:"";i!==""&&s.push(i);const a=typeof(t==null?void 0:t.transform)<"u"?"render/image":"object",l=this.transformOptsToQueryString((t==null?void 0:t.transform)||{});l!==""&&s.push(l);let u=s.join("&");return u!==""&&(u=`?${u}`),{data:{publicUrl:encodeURI(`${this.url}/${a}/public/${r}${u}`)}}}remove(e){return te(this,void 0,void 0,function*(){try{return{data:yield Xn(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(t){if(H(t))return{data:null,error:t};throw t}})}list(e,t,r){return te(this,void 0,void 0,function*(){try{const s=Object.assign(Object.assign(Object.assign({},To),t),{prefix:e||""});return{data:yield me(this.fetch,`${this.url}/object/list/${this.bucketId}`,s,{headers:this.headers},r),error:null}}catch(s){if(H(s))return{data:null,error:s};throw s}})}_getFinalPath(e){return`${this.bucketId}/${e}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}}const Oo="2.5.5",So={"X-Client-Info":`storage-js/${Oo}`};var $e=function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function a(c){try{u(r.next(c))}catch(h){o(h)}}function l(c){try{u(r.throw(c))}catch(h){o(h)}}function u(c){c.done?i(c.value):s(c.value).then(a,l)}u((r=r.apply(n,e||[])).next())})};class Ao{constructor(e,t={},r){this.url=e,this.headers=Object.assign(Object.assign({},So),t),this.fetch=Yn(r)}listBuckets(){return $e(this,void 0,void 0,function*(){try{return{data:yield mr(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(H(e))return{data:null,error:e};throw e}})}getBucket(e){return $e(this,void 0,void 0,function*(){try{return{data:yield mr(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(t){if(H(t))return{data:null,error:t};throw t}})}createBucket(e,t={public:!1}){return $e(this,void 0,void 0,function*(){try{return{data:yield me(this.fetch,`${this.url}/bucket`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(H(r))return{data:null,error:r};throw r}})}updateBucket(e,t){return $e(this,void 0,void 0,function*(){try{return{data:yield Eo(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(H(r))return{data:null,error:r};throw r}})}emptyBucket(e){return $e(this,void 0,void 0,function*(){try{return{data:yield me(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(t){if(H(t))return{data:null,error:t};throw t}})}deleteBucket(e){return $e(this,void 0,void 0,function*(){try{return{data:yield Xn(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(t){if(H(t))return{data:null,error:t};throw t}})}}class Do extends Ao{constructor(e,t={},r){super(e,t,r)}from(e){return new ko(this.url,this.headers,e,this.fetch)}}const Io="2.39.8";let nt="";typeof Deno<"u"?nt="deno":typeof document<"u"?nt="web":typeof navigator<"u"&&navigator.product==="ReactNative"?nt="react-native":nt="node";const Ro={"X-Client-Info":`supabase-js-${nt}/${Io}`},Co={headers:Ro},Po={schema:"public"},xo={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},Lo={};var jo=function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function a(c){try{u(r.next(c))}catch(h){o(h)}}function l(c){try{u(r.throw(c))}catch(h){o(h)}}function u(c){c.done?i(c.value):s(c.value).then(a,l)}u((r=r.apply(n,e||[])).next())})};const $o=n=>{let e;return n?e=n:typeof fetch>"u"?e=Or:e=fetch,(...t)=>e(...t)},No=()=>typeof Headers>"u"?Jn:Headers,Uo=(n,e,t)=>{const r=$o(t),s=No();return(i,o)=>jo(void 0,void 0,void 0,function*(){var a;const l=(a=yield e())!==null&&a!==void 0?a:n;let u=new s(o==null?void 0:o.headers);return u.has("apikey")||u.set("apikey",n),u.has("Authorization")||u.set("Authorization",`Bearer ${l}`),r(i,Object.assign(Object.assign({},o),{headers:u}))})};function Mo(n){return n.replace(/\/$/,"")}function Fo(n,e){const{db:t,auth:r,realtime:s,global:i}=n,{db:o,auth:a,realtime:l,global:u}=e;return{db:Object.assign(Object.assign({},o),t),auth:Object.assign(Object.assign({},a),r),realtime:Object.assign(Object.assign({},l),s),global:Object.assign(Object.assign({},u),i)}}function Bo(n){return Math.round(Date.now()/1e3)+n}function Go(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){const e=Math.random()*16|0;return(n=="x"?e:e&3|8).toString(16)})}const ie=()=>typeof document<"u",Oe={tested:!1,writable:!1},ct=()=>{if(!ie())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Oe.tested)return Oe.writable;const n=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(n,n),globalThis.localStorage.removeItem(n),Oe.tested=!0,Oe.writable=!0}catch{Oe.tested=!0,Oe.writable=!1}return Oe.writable};function er(n){const e={},t=new URL(n);if(t.hash&&t.hash[0]==="#")try{new URLSearchParams(t.hash.substring(1)).forEach((s,i)=>{e[i]=s})}catch{}return t.searchParams.forEach((r,s)=>{e[s]=r}),e}const Qn=n=>{let e;return n?e=n:typeof fetch>"u"?e=(...t)=>Ke(()=>Promise.resolve().then(()=>wt),void 0,import.meta.url).then(({default:r})=>r(...t)):e=fetch,(...t)=>e(...t)},zo=n=>typeof n=="object"&&n!==null&&"status"in n&&"ok"in n&&"json"in n&&typeof n.json=="function",Se=async(n,e,t)=>{await n.setItem(e,JSON.stringify(t))},Tt=async(n,e)=>{const t=await n.getItem(e);if(!t)return null;try{return JSON.parse(t)}catch{return t}},tr=async(n,e)=>{await n.removeItem(e)};function Ho(n){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let t="",r,s,i,o,a,l,u,c=0;for(n=n.replace("-","+").replace("_","/");c<n.length;)o=e.indexOf(n.charAt(c++)),a=e.indexOf(n.charAt(c++)),l=e.indexOf(n.charAt(c++)),u=e.indexOf(n.charAt(c++)),r=o<<2|a>>4,s=(a&15)<<4|l>>2,i=(l&3)<<6|u,t=t+String.fromCharCode(r),l!=64&&s!=0&&(t=t+String.fromCharCode(s)),u!=64&&i!=0&&(t=t+String.fromCharCode(i));return t}class Zt{constructor(){this.promise=new Zt.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}Zt.promiseConstructor=Promise;function sn(n){const e=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}=?$|[a-z0-9_-]{2}(==)?$)$/i,t=n.split(".");if(t.length!==3)throw new Error("JWT is not valid: not a JWT structure");if(!e.test(t[1]))throw new Error("JWT is not valid: payload is not in base64url format");const r=t[1];return JSON.parse(Ho(r))}async function qo(n){return await new Promise(e=>{setTimeout(()=>e(null),n)})}function Wo(n,e){return new Promise((r,s)=>{(async()=>{for(let i=0;i<1/0;i++)try{const o=await n(i);if(!e(i,null,o)){r(o);return}}catch(o){if(!e(i,o)){s(o);return}}})()})}function Jo(n){return("0"+n.toString(16)).substr(-2)}function Ne(){const e=new Uint32Array(56);if(typeof crypto>"u"){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",r=t.length;let s="";for(let i=0;i<56;i++)s+=t.charAt(Math.floor(Math.random()*r));return s}return crypto.getRandomValues(e),Array.from(e,Jo).join("")}async function Vo(n){const t=new TextEncoder().encode(n),r=await crypto.subtle.digest("SHA-256",t),s=new Uint8Array(r);return Array.from(s).map(i=>String.fromCharCode(i)).join("")}function Ko(n){return btoa(n).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Ue(n){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),n;const t=await Vo(n);return Ko(t)}class Ir extends Error{constructor(e,t){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t}}function S(n){return typeof n=="object"&&n!==null&&"__isAuthError"in n}class Zo extends Ir{constructor(e,t){super(e,t),this.name="AuthApiError",this.status=t}toJSON(){return{name:this.name,message:this.message,status:this.status}}}function Yo(n){return S(n)&&n.name==="AuthApiError"}class es extends Ir{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class Le extends Ir{constructor(e,t,r){super(e),this.name=t,this.status=r}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class Me extends Le{constructor(){super("Auth session missing!","AuthSessionMissingError",400)}}class rr extends Le{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500)}}class kt extends Le{constructor(e){super(e,"AuthInvalidCredentialsError",400)}}class Ot extends Le{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class on extends Le{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class pr extends Le{constructor(e,t){super(e,"AuthRetryableFetchError",t)}}function nr(n){return S(n)&&n.name==="AuthRetryableFetchError"}class Xo extends Le{constructor(e,t,r){super(e,"AuthWeakPasswordError",t),this.reasons=r}}var Qo=function(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(n);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(n,r[s])&&(t[r[s]]=n[r[s]]);return t};const Ge=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),ea=[502,503,504];async function an(n){if(!zo(n))throw new pr(Ge(n),0);if(ea.includes(n.status))throw new pr(Ge(n),n.status);let e;try{e=await n.json()}catch(t){throw new es(Ge(t),t)}throw typeof e=="object"&&e&&typeof e.weak_password=="object"&&e.weak_password&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.reasons.reduce((t,r)=>t&&typeof r=="string",!0)?new Xo(Ge(e),n.status,e.weak_password.reasons):new Zo(Ge(e),n.status||500)}const ta=(n,e,t,r)=>{const s={method:n,headers:(e==null?void 0:e.headers)||{}};return n==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),s.body=JSON.stringify(r),Object.assign(Object.assign({},s),t))};async function D(n,e,t,r){var s;const i=Object.assign({},r==null?void 0:r.headers);r!=null&&r.jwt&&(i.Authorization=`Bearer ${r.jwt}`);const o=(s=r==null?void 0:r.query)!==null&&s!==void 0?s:{};r!=null&&r.redirectTo&&(o.redirect_to=r.redirectTo);const a=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",l=await ra(n,e,t+a,{headers:i,noResolveJson:r==null?void 0:r.noResolveJson},{},r==null?void 0:r.body);return r!=null&&r.xform?r==null?void 0:r.xform(l):{data:Object.assign({},l),error:null}}async function ra(n,e,t,r,s,i){const o=ta(e,r,s,i);let a;try{a=await n(t,o)}catch(l){throw console.error(l),new pr(Ge(l),0)}if(a.ok||await an(a),r!=null&&r.noResolveJson)return a;try{return await a.json()}catch(l){await an(l)}}function De(n){var e;let t=null;oa(n)&&(t=Object.assign({},n),n.expires_at||(t.expires_at=Bo(n.expires_in)));const r=(e=n.user)!==null&&e!==void 0?e:n;return{data:{session:t,user:r},error:null}}function ln(n){const e=De(n);return!e.error&&n.weak_password&&typeof n.weak_password=="object"&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.message&&typeof n.weak_password.message=="string"&&n.weak_password.reasons.reduce((t,r)=>t&&typeof r=="string",!0)&&(e.data.weak_password=n.weak_password),e}function ve(n){var e;return{data:{user:(e=n.user)!==null&&e!==void 0?e:n},error:null}}function na(n){return{data:n,error:null}}function sa(n){const{action_link:e,email_otp:t,hashed_token:r,redirect_to:s,verification_type:i}=n,o=Qo(n,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),a={action_link:e,email_otp:t,hashed_token:r,redirect_to:s,verification_type:i},l=Object.assign({},o);return{data:{properties:a,user:l},error:null}}function ia(n){return n}function oa(n){return n.access_token&&n.refresh_token&&n.expires_in}var aa=function(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(n);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(n,r[s])&&(t[r[s]]=n[r[s]]);return t};class la{constructor({url:e="",headers:t={},fetch:r}){this.url=e,this.headers=t,this.fetch=Qn(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,t="global"){try{return await D(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(r){if(S(r))return{data:null,error:r};throw r}}async inviteUserByEmail(e,t={}){try{return await D(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:ve})}catch(r){if(S(r))return{data:{user:null},error:r};throw r}}async generateLink(e){try{const{options:t}=e,r=aa(e,["options"]),s=Object.assign(Object.assign({},r),t);return"newEmail"in r&&(s.new_email=r==null?void 0:r.newEmail,delete s.newEmail),await D(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:s,headers:this.headers,xform:sa,redirectTo:t==null?void 0:t.redirectTo})}catch(t){if(S(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await D(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:ve})}catch(t){if(S(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,r,s,i,o,a,l;try{const u={nextPage:null,lastPage:0,total:0},c=await D(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(r=(t=e==null?void 0:e.page)===null||t===void 0?void 0:t.toString())!==null&&r!==void 0?r:"",per_page:(i=(s=e==null?void 0:e.perPage)===null||s===void 0?void 0:s.toString())!==null&&i!==void 0?i:""},xform:ia});if(c.error)throw c.error;const h=await c.json(),d=(o=c.headers.get("x-total-count"))!==null&&o!==void 0?o:0,f=(l=(a=c.headers.get("link"))===null||a===void 0?void 0:a.split(","))!==null&&l!==void 0?l:[];return f.length>0&&(f.forEach(g=>{const m=parseInt(g.split(";")[0].split("=")[1].substring(0,1)),p=JSON.parse(g.split(";")[1].split("=")[1]);u[`${p}Page`]=m}),u.total=parseInt(d)),{data:Object.assign(Object.assign({},h),u),error:null}}catch(u){if(S(u))return{data:{users:[]},error:u};throw u}}async getUserById(e){try{return await D(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:ve})}catch(t){if(S(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){try{return await D(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:ve})}catch(r){if(S(r))return{data:{user:null},error:r};throw r}}async deleteUser(e,t=!1){try{return await D(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:ve})}catch(r){if(S(r))return{data:{user:null},error:r};throw r}}async _listFactors(e){try{const{data:t,error:r}=await D(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:s=>({data:{factors:s},error:null})});return{data:t,error:r}}catch(t){if(S(t))return{data:null,error:t};throw t}}async _deleteFactor(e){try{return{data:await D(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(t){if(S(t))return{data:null,error:t};throw t}}}const ts="0.0.0",ca="http://localhost:9999",ua="supabase.auth.token",ha={"X-Client-Info":`gotrue-js/${ts}`},cn=10,da={getItem:n=>ct()?globalThis.localStorage.getItem(n):null,setItem:(n,e)=>{ct()&&globalThis.localStorage.setItem(n,e)},removeItem:n=>{ct()&&globalThis.localStorage.removeItem(n)}};function un(n={}){return{getItem:e=>n[e]||null,setItem:(e,t)=>{n[e]=t},removeItem:e=>{delete n[e]}}}function fa(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const Fe={debug:!!(globalThis&&ct()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class rs extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class ga extends rs{}async function ma(n,e,t){Fe.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",n,e);const r=new globalThis.AbortController;return e>0&&setTimeout(()=>{r.abort(),Fe.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",n)},e),await globalThis.navigator.locks.request(n,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:r.signal},async s=>{if(s){Fe.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",n,s.name);try{return await t()}finally{Fe.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",n,s.name)}}else{if(e===0)throw Fe.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",n),new ga(`Acquiring an exclusive Navigator LockManager lock "${n}" immediately failed`);if(Fe.debug)try{const i=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await t()}})}fa();const pa={url:ca,storageKey:ua,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:ha,flowType:"implicit",debug:!1},rt=30*1e3,hn=3;async function dn(n,e,t){return await t()}class ft{constructor(e){var t,r;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=ft.nextInstanceID,ft.nextInstanceID+=1,this.instanceID>0&&ie()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const s=Object.assign(Object.assign({},pa),e);if(this.logDebugMessages=!!s.debug,typeof s.debug=="function"&&(this.logger=s.debug),this.persistSession=s.persistSession,this.storageKey=s.storageKey,this.autoRefreshToken=s.autoRefreshToken,this.admin=new la({url:s.url,headers:s.headers,fetch:s.fetch}),this.url=s.url,this.headers=s.headers,this.fetch=Qn(s.fetch),this.lock=s.lock||dn,this.detectSessionInUrl=s.detectSessionInUrl,this.flowType=s.flowType,s.lock?this.lock=s.lock:ie()&&(!((t=globalThis==null?void 0:globalThis.navigator)===null||t===void 0)&&t.locks)?this.lock=ma:this.lock=dn,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?s.storage?this.storage=s.storage:ct()?this.storage=da:(this.memoryStorage={},this.storage=un(this.memoryStorage)):(this.memoryStorage={},this.storage=un(this.memoryStorage)),ie()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(i){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",i)}(r=this.broadcastChannel)===null||r===void 0||r.addEventListener("message",async i=>{this._debug("received broadcast notification from other tab or client",i),await this._notifyAllSubscribers(i.data.event,i.data.session,!1)})}this.initialize()}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${ts}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){try{const e=ie()?await this._isPKCEFlow():!1;if(this._debug("#_initialize()","begin","is PKCE flow",e),e||this.detectSessionInUrl&&this._isImplicitGrantFlow()){const{data:t,error:r}=await this._getSessionFromURL(e);if(r)return this._debug("#_initialize()","error detecting session from URL",r),(r==null?void 0:r.message)==="Identity is already linked"||(r==null?void 0:r.message)==="Identity is already linked to another user"?{error:r}:(await this._removeSession(),{error:r});const{session:s,redirectType:i}=t;return this._debug("#_initialize()","detected session in URL",s,"redirect type",i),await this._saveSession(s),setTimeout(async()=>{i==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",s):await this._notifyAllSubscribers("SIGNED_IN",s)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(e){return S(e)?{error:e}:{error:new es("Unexpected error during initialization",e)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signUp(e){var t,r,s;try{await this._removeSession();let i;if("email"in e){const{email:c,password:h,options:d}=e;let f=null,g=null;if(this.flowType==="pkce"){const m=Ne();await Se(this.storage,`${this.storageKey}-code-verifier`,m),f=await Ue(m),g=m===f?"plain":"s256"}i=await D(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:d==null?void 0:d.emailRedirectTo,body:{email:c,password:h,data:(t=d==null?void 0:d.data)!==null&&t!==void 0?t:{},gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken},code_challenge:f,code_challenge_method:g},xform:De})}else if("phone"in e){const{phone:c,password:h,options:d}=e;i=await D(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:c,password:h,data:(r=d==null?void 0:d.data)!==null&&r!==void 0?r:{},channel:(s=d==null?void 0:d.channel)!==null&&s!==void 0?s:"sms",gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken}},xform:De})}else throw new kt("You must provide either an email or phone number and a password");const{data:o,error:a}=i;if(a||!o)return{data:{user:null,session:null},error:a};const l=o.session,u=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:u,session:l},error:null}}catch(i){if(S(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithPassword(e){try{await this._removeSession();let t;if("email"in e){const{email:i,password:o,options:a}=e;t=await D(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:o,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},xform:ln})}else if("phone"in e){const{phone:i,password:o,options:a}=e;t=await D(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:o,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},xform:ln})}else throw new kt("You must provide either an email or phone number and a password");const{data:r,error:s}=t;return s?{data:{user:null,session:null},error:s}:!r||!r.session||!r.user?{data:{user:null,session:null},error:new rr}:(r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),{data:Object.assign({user:r.user,session:r.session},r.weak_password?{weakPassword:r.weak_password}:null),error:s})}catch(t){if(S(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOAuth(e){var t,r,s,i;return await this._removeSession(),await this._handleProviderSignIn(e.provider,{redirectTo:(t=e.options)===null||t===void 0?void 0:t.redirectTo,scopes:(r=e.options)===null||r===void 0?void 0:r.scopes,queryParams:(s=e.options)===null||s===void 0?void 0:s.queryParams,skipBrowserRedirect:(i=e.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async _exchangeCodeForSession(e){const t=await Tt(this.storage,`${this.storageKey}-code-verifier`),[r,s]=(t??"").split("/"),{data:i,error:o}=await D(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:r},xform:De});return await tr(this.storage,`${this.storageKey}-code-verifier`),o?{data:{user:null,session:null,redirectType:null},error:o}:!i||!i.session||!i.user?{data:{user:null,session:null,redirectType:null},error:new rr}:(i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),{data:Object.assign(Object.assign({},i),{redirectType:s??null}),error:o})}async signInWithIdToken(e){await this._removeSession();try{const{options:t,provider:r,token:s,access_token:i,nonce:o}=e,a=await D(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:r,id_token:s,access_token:i,nonce:o,gotrue_meta_security:{captcha_token:t==null?void 0:t.captchaToken}},xform:De}),{data:l,error:u}=a;return u?{data:{user:null,session:null},error:u}:!l||!l.session||!l.user?{data:{user:null,session:null},error:new rr}:(l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),{data:l,error:u})}catch(t){if(S(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOtp(e){var t,r,s,i,o;try{if(await this._removeSession(),"email"in e){const{email:a,options:l}=e;let u=null,c=null;if(this.flowType==="pkce"){const d=Ne();await Se(this.storage,`${this.storageKey}-code-verifier`,d),u=await Ue(d),c=d===u?"plain":"s256"}const{error:h}=await D(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:a,data:(t=l==null?void 0:l.data)!==null&&t!==void 0?t:{},create_user:(r=l==null?void 0:l.shouldCreateUser)!==null&&r!==void 0?r:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},code_challenge:u,code_challenge_method:c},redirectTo:l==null?void 0:l.emailRedirectTo});return{data:{user:null,session:null},error:h}}if("phone"in e){const{phone:a,options:l}=e,{data:u,error:c}=await D(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:a,data:(s=l==null?void 0:l.data)!==null&&s!==void 0?s:{},create_user:(i=l==null?void 0:l.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},channel:(o=l==null?void 0:l.channel)!==null&&o!==void 0?o:"sms"}});return{data:{user:null,session:null,messageId:u==null?void 0:u.message_id},error:c}}throw new kt("You must provide either an email or phone number.")}catch(a){if(S(a))return{data:{user:null,session:null},error:a};throw a}}async verifyOtp(e){var t,r;try{e.type!=="email_change"&&e.type!=="phone_change"&&await this._removeSession();let s,i;"options"in e&&(s=(t=e.options)===null||t===void 0?void 0:t.redirectTo,i=(r=e.options)===null||r===void 0?void 0:r.captchaToken);const{data:o,error:a}=await D(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:i}}),redirectTo:s,xform:De});if(a)throw a;if(!o)throw new Error("An error occurred on token verification.");const l=o.session,u=o.user;return l!=null&&l.access_token&&(await this._saveSession(l),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",l)),{data:{user:u,session:l},error:null}}catch(s){if(S(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithSSO(e){var t,r,s;try{await this._removeSession();let i=null,o=null;if(this.flowType==="pkce"){const a=Ne();await Se(this.storage,`${this.storageKey}-code-verifier`,a),i=await Ue(a),o=a===i?"plain":"s256"}return await D(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(r=(t=e.options)===null||t===void 0?void 0:t.redirectTo)!==null&&r!==void 0?r:void 0}),!((s=e==null?void 0:e.options)===null||s===void 0)&&s.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:i,code_challenge_method:o}),headers:this.headers,xform:na})}catch(i){if(S(i))return{data:null,error:i};throw i}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:t},error:r}=e;if(r)throw r;if(!t)throw new Me;const{error:s}=await D(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return{data:{user:null,session:null},error:s}})}catch(e){if(S(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{e.type!="email_change"&&e.type!="phone_change"&&await this._removeSession();const t=`${this.url}/resend`;if("email"in e){const{email:r,type:s,options:i}=e,{error:o}=await D(this.fetch,"POST",t,{headers:this.headers,body:{email:r,type:s,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},redirectTo:i==null?void 0:i.emailRedirectTo});return{data:{user:null,session:null},error:o}}else if("phone"in e){const{phone:r,type:s,options:i}=e,{data:o,error:a}=await D(this.fetch,"POST",t,{headers:this.headers,body:{phone:r,type:s,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}}});return{data:{user:null,session:null,messageId:o==null?void 0:o.message_id},error:a}}throw new kt("You must provide either an email or phone number and a type")}catch(t){if(S(t))return{data:{user:null,session:null},error:t};throw t}}async getSession(){return await this.initializePromise,this._acquireLock(-1,async()=>this._useSession(async e=>e))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const r=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),s=(async()=>(await r,await t()))();return this.pendingInLock.push((async()=>{try{await s}catch{}})()),s}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const r=t();for(this.pendingInLock.push((async()=>{try{await r}catch{}})()),await r;this.pendingInLock.length;){const s=[...this.pendingInLock];await Promise.all(s),this.pendingInLock.splice(0,s.length)}return await r}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const t=await Tt(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),t!==null&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const r=e.expires_at?e.expires_at<=Date.now()/1e3:!1;if(this._debug("#__loadSession()",`session has${r?"":" not"} expired`,"expires_at",e.expires_at),!r)return{data:{session:e},error:null};const{session:s,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{session:null},error:i}:{data:{session:s},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await D(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:ve}):await this._useSession(async t=>{var r,s;const{data:i,error:o}=t;if(o)throw o;return await D(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(s=(r=i.session)===null||r===void 0?void 0:r.access_token)!==null&&s!==void 0?s:void 0,xform:ve})})}catch(t){if(S(t))return{data:{user:null},error:t};throw t}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,t))}async _updateUser(e,t={}){try{return await this._useSession(async r=>{const{data:s,error:i}=r;if(i)throw i;if(!s.session)throw new Me;const o=s.session;let a=null,l=null;if(this.flowType==="pkce"&&e.email!=null){const h=Ne();await Se(this.storage,`${this.storageKey}-code-verifier`,h),a=await Ue(h),l=h===a?"plain":"s256"}const{data:u,error:c}=await D(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:t==null?void 0:t.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:a,code_challenge_method:l}),jwt:o.access_token,xform:ve});if(c)throw c;return o.user=u.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),{data:{user:o.user},error:null}})}catch(r){if(S(r))return{data:{user:null},error:r};throw r}}_decodeJWT(e){return sn(e)}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new Me;const t=Date.now()/1e3;let r=t,s=!0,i=null;const o=sn(e.access_token);if(o.exp&&(r=o.exp,s=r<=t),s){const{session:a,error:l}=await this._callRefreshToken(e.refresh_token);if(l)return{data:{user:null,session:null},error:l};if(!a)return{data:{user:null,session:null},error:null};i=a}else{const{data:a,error:l}=await this._getUser(e.access_token);if(l)throw l;i={access_token:e.access_token,refresh_token:e.refresh_token,user:a.user,token_type:"bearer",expires_in:r-t,expires_at:r},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return{data:{user:i.user,session:i},error:null}}catch(t){if(S(t))return{data:{session:null,user:null},error:t};throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var r;if(!e){const{data:o,error:a}=t;if(a)throw a;e=(r=o.session)!==null&&r!==void 0?r:void 0}if(!(e!=null&&e.refresh_token))throw new Me;const{session:s,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{user:null,session:null},error:i}:s?{data:{user:s.user,session:s},error:null}:{data:{user:null,session:null},error:null}})}catch(t){if(S(t))return{data:{user:null,session:null},error:t};throw t}}async _getSessionFromURL(e){try{if(!ie())throw new Ot("No browser detected.");if(this.flowType==="implicit"&&!this._isImplicitGrantFlow())throw new Ot("Not a valid implicit grant flow url.");if(this.flowType=="pkce"&&!e)throw new on("Not a valid PKCE flow url.");const t=er(window.location.href);if(e){if(!t.code)throw new on("No code detected.");const{data:y,error:T}=await this._exchangeCodeForSession(t.code);if(T)throw T;const w=new URL(window.location.href);return w.searchParams.delete("code"),window.history.replaceState(window.history.state,"",w.toString()),{data:{session:y.session,redirectType:null},error:null}}if(t.error||t.error_description||t.error_code)throw new Ot(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});const{provider_token:r,provider_refresh_token:s,access_token:i,refresh_token:o,expires_in:a,expires_at:l,token_type:u}=t;if(!i||!a||!o||!u)throw new Ot("No session defined in URL");const c=Math.round(Date.now()/1e3),h=parseInt(a);let d=c+h;l&&(d=parseInt(l));const f=d-c;f*1e3<=rt&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${f}s, should have been closer to ${h}s`);const g=d-h;c-g>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",g,d,c):c-g<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clok for skew",g,d,c);const{data:m,error:p}=await this._getUser(i);if(p)throw p;const _={provider_token:r,provider_refresh_token:s,access_token:i,expires_in:h,expires_at:d,refresh_token:o,token_type:u,user:m.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:_,redirectType:t.type},error:null}}catch(t){if(S(t))return{data:{session:null,redirectType:null},error:t};throw t}}_isImplicitGrantFlow(){const e=er(window.location.href);return!!(ie()&&(e.access_token||e.error_description))}async _isPKCEFlow(){const e=er(window.location.href),t=await Tt(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var r;const{data:s,error:i}=t;if(i)return{error:i};const o=(r=s.session)===null||r===void 0?void 0:r.access_token;if(o){const{error:a}=await this.admin.signOut(o,e);if(a&&!(Yo(a)&&(a.status===404||a.status===401)))return{error:a}}return e!=="others"&&(await this._removeSession(),await tr(this.storage,`${this.storageKey}-code-verifier`),await this._notifyAllSubscribers("SIGNED_OUT",null)),{error:null}})}onAuthStateChange(e){const t=Go(),r={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,r),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(t)})))(),{data:{subscription:r}}}async _emitInitialSession(e){return await this._useSession(async t=>{var r,s;try{const{data:{session:i},error:o}=t;if(o)throw o;await((r=this.stateChangeEmitters.get(e))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",e,"session",i)}catch(i){await((s=this.stateChangeEmitters.get(e))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",i),console.error(i)}})}async resetPasswordForEmail(e,t={}){let r=null,s=null;if(this.flowType==="pkce"){const i=Ne();await Se(this.storage,`${this.storageKey}-code-verifier`,`${i}/PASSWORD_RECOVERY`),r=await Ue(i),s=i===r?"plain":"s256"}try{return await D(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:r,code_challenge_method:s,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(i){if(S(i))return{data:null,error:i};throw i}}async getUserIdentities(){var e;try{const{data:t,error:r}=await this.getUser();if(r)throw r;return{data:{identities:(e=t.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(t){if(S(t))return{data:null,error:t};throw t}}async linkIdentity(e){var t;try{const{data:r,error:s}=await this._useSession(async i=>{var o,a,l,u,c;const{data:h,error:d}=i;if(d)throw d;const f=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(o=e.options)===null||o===void 0?void 0:o.redirectTo,scopes:(a=e.options)===null||a===void 0?void 0:a.scopes,queryParams:(l=e.options)===null||l===void 0?void 0:l.queryParams,skipBrowserRedirect:!0});return await D(this.fetch,"GET",f,{headers:this.headers,jwt:(c=(u=h.session)===null||u===void 0?void 0:u.access_token)!==null&&c!==void 0?c:void 0})});if(s)throw s;return ie()&&!(!((t=e.options)===null||t===void 0)&&t.skipBrowserRedirect)&&window.location.assign(r==null?void 0:r.url),{data:{provider:e.provider,url:r==null?void 0:r.url},error:null}}catch(r){if(S(r))return{data:{provider:e.provider,url:null},error:r};throw r}}async unlinkIdentity(e){try{return await this._useSession(async t=>{var r,s;const{data:i,error:o}=t;if(o)throw o;return await D(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(s=(r=i.session)===null||r===void 0?void 0:r.access_token)!==null&&s!==void 0?s:void 0})})}catch(t){if(S(t))return{data:null,error:t};throw t}}async _refreshAccessToken(e){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const r=Date.now();return await Wo(async s=>(await qo(s*200),this._debug(t,"refreshing attempt",s),await D(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:De})),(s,i,o)=>o&&o.error&&nr(o.error)&&Date.now()+(s+1)*200-r<rt)}catch(r){if(this._debug(t,"error",r),S(r))return{data:{session:null,user:null},error:r};throw r}finally{this._debug(t,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const r=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",r),ie()&&!t.skipBrowserRedirect&&window.location.assign(r),{data:{provider:e,url:r},error:null}}async _recoverAndRefresh(){var e;const t="#_recoverAndRefresh()";this._debug(t,"begin");try{const r=await Tt(this.storage,this.storageKey);if(this._debug(t,"session from storage",r),!this._isValidSession(r)){this._debug(t,"session is not valid"),r!==null&&await this._removeSession();return}const s=Math.round(Date.now()/1e3),i=((e=r.expires_at)!==null&&e!==void 0?e:1/0)<s+cn;if(this._debug(t,`session has${i?"":" not"} expired with margin of ${cn}s`),i){if(this.autoRefreshToken&&r.refresh_token){const{error:o}=await this._callRefreshToken(r.refresh_token);o&&(console.error(o),nr(o)||(this._debug(t,"refresh failed with a non-retryable error, removing the session",o),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",r)}catch(r){this._debug(t,"error",r),console.error(r);return}finally{this._debug(t,"end")}}async _callRefreshToken(e){var t,r;if(!e)throw new Me;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const s=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(s,"begin");try{this.refreshingDeferred=new Zt;const{data:i,error:o}=await this._refreshAccessToken(e);if(o)throw o;if(!i.session)throw new Me;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const a={session:i.session,error:null};return this.refreshingDeferred.resolve(a),a}catch(i){if(this._debug(s,"error",i),S(i)){const o={session:null,error:i};return nr(i)||(await this._removeSession(),await this._notifyAllSubscribers("SIGNED_OUT",null)),(t=this.refreshingDeferred)===null||t===void 0||t.resolve(o),o}throw(r=this.refreshingDeferred)===null||r===void 0||r.reject(i),i}finally{this.refreshingDeferred=null,this._debug(s,"end")}}async _notifyAllSubscribers(e,t,r=!0){const s=`#_notifyAllSubscribers(${e})`;this._debug(s,"begin",t,`broadcast = ${r}`);try{this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:e,session:t});const i=[],o=Array.from(this.stateChangeEmitters.values()).map(async a=>{try{await a.callback(e,t)}catch(l){i.push(l)}});if(await Promise.all(o),i.length>0){for(let a=0;a<i.length;a+=1)console.error(i[a]);throw i[0]}}finally{this._debug(s,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),await Se(this.storage,this.storageKey,e)}async _removeSession(){this._debug("#_removeSession()"),await tr(this.storage,this.storageKey)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&ie()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),rt);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async t=>{const{data:{session:r}}=t;if(!r||!r.refresh_token||!r.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const s=Math.floor((r.expires_at*1e3-e)/rt);this._debug("#_autoRefreshTokenTick()",`access token expires in ${s} ticks, a tick lasts ${rt}ms, refresh threshold is ${hn} ticks`),s<=hn&&await this._callRefreshToken(r.refresh_token)})}catch(t){console.error("Auto refresh tick failed with error. This is likely a transient error.",t)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof rs)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!ie()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,r){const s=[`provider=${encodeURIComponent(t)}`];if(r!=null&&r.redirectTo&&s.push(`redirect_to=${encodeURIComponent(r.redirectTo)}`),r!=null&&r.scopes&&s.push(`scopes=${encodeURIComponent(r.scopes)}`),this.flowType==="pkce"){const i=Ne();await Se(this.storage,`${this.storageKey}-code-verifier`,i);const o=await Ue(i),a=i===o?"plain":"s256";this._debug("PKCE","code verifier",`${i.substring(0,5)}...`,"code challenge",o,"method",a);const l=new URLSearchParams({code_challenge:`${encodeURIComponent(o)}`,code_challenge_method:`${encodeURIComponent(a)}`});s.push(l.toString())}if(r!=null&&r.queryParams){const i=new URLSearchParams(r.queryParams);s.push(i.toString())}return r!=null&&r.skipBrowserRedirect&&s.push(`skip_http_redirect=${r.skipBrowserRedirect}`),`${e}?${s.join("&")}`}async _unenroll(e){try{return await this._useSession(async t=>{var r;const{data:s,error:i}=t;return i?{data:null,error:i}:await D(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(r=s==null?void 0:s.session)===null||r===void 0?void 0:r.access_token})})}catch(t){if(S(t))return{data:null,error:t};throw t}}async _enroll(e){try{return await this._useSession(async t=>{var r,s;const{data:i,error:o}=t;if(o)return{data:null,error:o};const{data:a,error:l}=await D(this.fetch,"POST",`${this.url}/factors`,{body:{friendly_name:e.friendlyName,factor_type:e.factorType,issuer:e.issuer},headers:this.headers,jwt:(r=i==null?void 0:i.session)===null||r===void 0?void 0:r.access_token});return l?{data:null,error:l}:(!((s=a==null?void 0:a.totp)===null||s===void 0)&&s.qr_code&&(a.totp.qr_code=`data:image/svg+xml;utf-8,${a.totp.qr_code}`),{data:a,error:null})})}catch(t){if(S(t))return{data:null,error:t};throw t}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var r;const{data:s,error:i}=t;if(i)return{data:null,error:i};const{data:o,error:a}=await D(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(r=s==null?void 0:s.session)===null||r===void 0?void 0:r.access_token});return a?{data:null,error:a}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+o.expires_in},o)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",o),{data:o,error:a})})}catch(t){if(S(t))return{data:null,error:t};throw t}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var r;const{data:s,error:i}=t;return i?{data:null,error:i}:await D(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{headers:this.headers,jwt:(r=s==null?void 0:s.session)===null||r===void 0?void 0:r.access_token})})}catch(t){if(S(t))return{data:null,error:t};throw t}})}async _challengeAndVerify(e){const{data:t,error:r}=await this._challenge({factorId:e.factorId});return r?{data:null,error:r}:await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){const{data:{user:e},error:t}=await this.getUser();if(t)return{data:null,error:t};const r=(e==null?void 0:e.factors)||[],s=r.filter(i=>i.factor_type==="totp"&&i.status==="verified");return{data:{all:r,totp:s},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var t,r;const{data:{session:s},error:i}=e;if(i)return{data:null,error:i};if(!s)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const o=this._decodeJWT(s.access_token);let a=null;o.aal&&(a=o.aal);let l=a;((r=(t=s.user.factors)===null||t===void 0?void 0:t.filter(h=>h.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(l="aal2");const c=o.amr||[];return{data:{currentLevel:a,nextLevel:l,currentAuthenticationMethods:c},error:null}}))}}ft.nextInstanceID=0;class va extends ft{constructor(e){super(e)}}var ya=function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function a(c){try{u(r.next(c))}catch(h){o(h)}}function l(c){try{u(r.throw(c))}catch(h){o(h)}}function u(c){c.done?i(c.value):s(c.value).then(a,l)}u((r=r.apply(n,e||[])).next())})};class _a{constructor(e,t,r){var s,i,o,a,l,u,c,h;if(this.supabaseUrl=e,this.supabaseKey=t,!e)throw new Error("supabaseUrl is required.");if(!t)throw new Error("supabaseKey is required.");const d=Mo(e);this.realtimeUrl=`${d}/realtime/v1`.replace(/^http/i,"ws"),this.authUrl=`${d}/auth/v1`,this.storageUrl=`${d}/storage/v1`,this.functionsUrl=`${d}/functions/v1`;const f=`sb-${new URL(this.authUrl).hostname.split(".")[0]}-auth-token`,g={db:Po,realtime:Lo,auth:Object.assign(Object.assign({},xo),{storageKey:f}),global:Co},m=Fo(r??{},g);this.storageKey=(i=(s=m.auth)===null||s===void 0?void 0:s.storageKey)!==null&&i!==void 0?i:"",this.headers=(a=(o=m.global)===null||o===void 0?void 0:o.headers)!==null&&a!==void 0?a:{},this.auth=this._initSupabaseAuthClient((l=m.auth)!==null&&l!==void 0?l:{},this.headers,(u=m.global)===null||u===void 0?void 0:u.fetch),this.fetch=Uo(t,this._getAccessToken.bind(this),(c=m.global)===null||c===void 0?void 0:c.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers},m.realtime)),this.rest=new Sr(`${d}/rest/v1`,{headers:this.headers,schema:(h=m.db)===null||h===void 0?void 0:h.schema,fetch:this.fetch}),this._listenForAuthEvents()}get functions(){return new Hi(this.functionsUrl,{headers:this.headers,customFetch:this.fetch})}get storage(){return new Do(this.storageUrl,this.headers,this.fetch)}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},r={}){return this.rest.rpc(e,t,r)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,t;return ya(this,void 0,void 0,function*(){const{data:r}=yield this.auth.getSession();return(t=(e=r.session)===null||e===void 0?void 0:e.access_token)!==null&&t!==void 0?t:null})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:s,storageKey:i,flowType:o,debug:a},l,u){const c={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new va({url:this.authUrl,headers:Object.assign(Object.assign({},c),l),storageKey:i,autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:s,flowType:o,debug:a,fetch:u})}_initRealtimeClient(e){return new mo(this.realtimeUrl,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((t,r)=>{this._handleTokenChanged(t,"CLIENT",r==null?void 0:r.access_token)})}_handleTokenChanged(e,t,r){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==r?(this.realtime.setAuth(r??null),this.changedAccessToken=r):e==="SIGNED_OUT"&&(this.realtime.setAuth(this.supabaseKey),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const wa=(n,e,t)=>new _a(n,e,t),ba="https://lwpcpixtrbcdhvktfvas.supabase.co",Ea="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imx3cGNwaXh0cmJjZGh2a3RmdmFzIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MTY2NTk5NTYsImV4cCI6MjAzMjIzNTk1Nn0.MY2A7T7t9DjfJhRNADoLukGlOfOsXvX3TryKOxI8XDI",Ta=wa(ba,Ea),ka=async(n,e)=>{if(console.log(n,e),e.detail.info.trigger=="droppedIntoZone"){let t=e.detail.info.id,r=n;const s=await Ta.from("entries").insert([{artist_id:t,gen:r}],{returning:"minimal"}).select();if(s.error)throw console.log(s.error),new Error("insert failed");return!0}};function fn(n,e,t){const r=n.slice();return r[10]=e[t],r}function gn(n,e,t){const r=n.slice();return r[13]=e[t],r}function mn(n,e){let t,r=e[13].name+"",s,i,o,a=ce,l,u;return{key:n,first:null,c(){t=R("div"),s=st(r),i=Pe(),this.h()},l(c){t=C(c,"DIV",{class:!0});var h=de(t);s=it(h,r),i=xe(h),h.forEach(k),this.h()},h(){v(t,"class","card svelte-8pkwha"),this.first=t},m(c,h){Ee(c,t,h),O(t,s),O(t,i),l||(u=Je(t,"click",function(){Bt(vn(e[13]))&&vn(e[13]).apply(this,arguments)}),l=!0)},p(c,h){e=c,h&1&&r!==(r=e[13].name+"")&&ot(s,r)},r(){o=t.getBoundingClientRect()},f(){Dn(t),a()},a(){a(),a=An(t,o,In,{duration:We})},d(c){c&&k(t),l=!1,u()}}}function pn(n,e){let t,r,s=[],i=new Map,o,a,l,u=e[10].name+"",c,h,d,f,g=ce,m,p,_=Ve(e[10].items);const y=b=>b[13].id;for(let b=0;b<_.length;b+=1){let I=gn(e,_,b),A=y(I);i.set(A,s[b]=mn(A,I))}function T(...b){return e[8](e[10],...b)}function w(...b){return e[9](e[10],...b)}return{key:n,first:null,c(){t=R("div"),r=R("div");for(let b=0;b<s.length;b+=1)s[b].c();a=Pe(),l=R("div"),c=st(u),h=Pe(),this.h()},l(b){t=C(b,"DIV",{class:!0});var I=de(t);r=C(I,"DIV",{class:!0});var A=de(r);for(let V=0;V<s.length;V+=1)s[V].l(A);A.forEach(k),a=xe(I),l=C(I,"DIV",{class:!0});var z=de(l);c=it(z,u),z.forEach(k),h=xe(I),I.forEach(k),this.h()},h(){v(r,"class","column-content svelte-8pkwha"),v(l,"class","column-title svelte-8pkwha"),v(t,"class",d="column "+(e[10].id==0?"column-artists":"column-gen")+" svelte-8pkwha"),this.first=t},m(b,I){Ee(b,t,I),O(t,r);for(let A=0;A<s.length;A+=1)s[A]&&s[A].m(r,null);O(t,a),O(t,l),O(l,c),O(t,h),m||(p=[bn(o=Wn.call(null,r,{centreDraggedOnCursor:!0,items:e[10].items,flipDurationMs:We,dropTargetStyle:e[3],transformDraggedElement:Ft})),Je(r,"consider",T),Je(r,"finalize",w)],m=!0)},p(b,I){if(e=b,I&1){_=Ve(e[10].items);for(let A=0;A<s.length;A+=1)s[A].r();s=On(s,I,y,1,e,_,i,r,Sn,mn,null,gn);for(let A=0;A<s.length;A+=1)s[A].a()}o&&Bt(o.update)&&I&1&&o.update.call(null,{centreDraggedOnCursor:!0,items:e[10].items,flipDurationMs:We,dropTargetStyle:e[3],transformDraggedElement:Ft}),I&1&&u!==(u=e[10].name+"")&&ot(c,u),I&1&&d!==(d="column "+(e[10].id==0?"column-artists":"column-gen")+" svelte-8pkwha")&&v(t,"class",d)},r(){f=t.getBoundingClientRect()},f(){Dn(t),g()},a(){g(),g=An(t,f,In,{duration:We})},d(b){b&&k(t);for(let I=0;I<s.length;I+=1)s[I].d();m=!1,En(p)}}}function Oa(n){let e,t=[],r=new Map,s,i,o,a=Ve(n[0]);const l=u=>u[10].id;for(let u=0;u<a.length;u+=1){let c=fn(n,a,u),h=l(c);r.set(h,t[u]=pn(h,c))}return{c(){e=R("section");for(let u=0;u<t.length;u+=1)t[u].c();this.h()},l(u){e=C(u,"SECTION",{class:!0,style:!0});var c=de(e);for(let h=0;h<t.length;h+=1)t[h].l(c);c.forEach(k),this.h()},h(){v(e,"class","board svelte-8pkwha"),Cr(e,"height",n[2].height+"px"),Pr(e,"experienceStarted",n[1])},m(u,c){Ee(u,e,c);for(let h=0;h<t.length;h+=1)t[h]&&t[h].m(e,null);i||(o=[bn(s=Wn.call(null,e,{items:n[0],flipDurationMs:We,type:"columns",transformDraggedElement:Ft})),Je(e,"consider",n[4]),Je(e,"finalize",n[5])],i=!0)},p(u,[c]){if(c&201){a=Ve(u[0]);for(let h=0;h<t.length;h+=1)t[h].r();t=On(t,c,l,1,u,a,r,e,Sn,pn,null,fn);for(let h=0;h<t.length;h+=1)t[h].a()}c&4&&Cr(e,"height",u[2].height+"px"),s&&Bt(s.update)&&c&1&&s.update.call(null,{items:u[0],flipDurationMs:We,type:"columns",transformDraggedElement:Ft}),c&2&&Pr(e,"experienceStarted",u[1])},i:ce,o:ce,d(u){u&&k(e);for(let c=0;c<t.length;c+=1)t[c].d();i=!1,En(o)}}}const We=200;async function vn(n){}function Ft(n,e,t){console.log(n,e),n.classList.add("dragging-artist"),n.innerHTML="helloo"}function Sa(n,e,t){let r;ls(n,gs,f=>t(2,r=f));let{columnItems:s}=e,{experienceStarted:i}=e,o={outline:"rgba(255, 0, 0, 1) solid 2px"};function a(f){t(0,s=f.detail.items)}function l(f){t(0,s=f.detail.items)}function u(f,g){const m=s.findIndex(p=>p.id===f);t(0,s[m].items=g.detail.items,s),t(0,s=[...s])}async function c(f,g){const m=s.findIndex(p=>p.id===f);t(0,s[m].items=g.detail.items,s),t(0,s=[...s]),await ka(f,g)}const h=(f,g)=>u(f.id,g),d=(f,g)=>c(f.id,g);return n.$$set=f=>{"columnItems"in f&&t(0,s=f.columnItems),"experienceStarted"in f&&t(1,i=f.experienceStarted)},[s,i,r,o,a,l,u,c,h,d]}class Aa extends mt{constructor(e){super(),pt(this,e,Sa,Oa,gt,{columnItems:0,experienceStarted:1})}}function yn(n){let e,t,r,s=!n[0]&&_n(n);return t=new Aa({props:{experienceStarted:n[0],columnItems:n[3]}}),{c(){s&&s.c(),e=Pe(),It(t.$$.fragment)},l(i){s&&s.l(i),e=xe(i),Rt(t.$$.fragment,i)},m(i,o){s&&s.m(i,o),Ee(i,e,o),Ct(t,i,o),r=!0},p(i,o){i[0]?s&&(Tn(),_e(s,1,1,()=>{s=null}),kn()):s?(s.p(i,o),o&1&&ge(s,1)):(s=_n(i),s.c(),ge(s,1),s.m(e.parentNode,e));const a={};o&1&&(a.experienceStarted=i[0]),t.$set(a)},i(i){r||(ge(s),ge(t.$$.fragment,i),r=!0)},o(i){_e(s),_e(t.$$.fragment,i),r=!1},d(i){i&&k(e),s&&s.d(i),Pt(t,i)}}}function _n(n){let e,t;return e=new Li({props:{copy:dr}}),e.$on("start",n[2]),{c(){It(e.$$.fragment)},l(r){Rt(e.$$.fragment,r)},m(r,s){Ct(e,r,s),t=!0},p:ce,i(r){t||(ge(e.$$.fragment,r),t=!0)},o(r){_e(e.$$.fragment,r),t=!1},d(r){Pt(e,r)}}}function Da(n){let e,t,r=n[1]&&yn(n);return{c(){r&&r.c(),e=Dt()},l(s){r&&r.l(s),e=Dt()},m(s,i){r&&r.m(s,i),Ee(s,e,i),t=!0},p(s,[i]){s[1]?r?(r.p(s,i),i&2&&ge(r,1)):(r=yn(s),r.c(),ge(r,1),r.m(e.parentNode,e)):r&&(Tn(),_e(r,1,1,()=>{r=null}),kn())},i(s){t||(ge(r),t=!0)},o(s){_e(r),t=!1},d(s){s&&k(e),r&&r.d(s)}}}function Ia(n,e,t){function r(a){t(0,i=a.detail.started)}let s=[{id:0,name:"artists",items:_s.slice(0,1)},{id:1,name:"First Gen",items:[]},{id:2,name:"Second Gen",items:[]},{id:3,name:"Third Gen",items:[]},{id:4,name:"Fourth Gen",items:[]},{id:5,name:"Fifth Gen",items:[]},{id:6,name:"Don't Know",items:[]}],i=!1,o=!1;return cs(async()=>{t(1,o=!0)}),n.$$.update=()=>{n.$$.dirty&1&&console.log(i)},[i,o,r,s]}class Ra extends mt{constructor(e){super(),pt(this,e,Ia,Da,gt,{})}}function Ca(){console.log("--- --- --- --- --- ---"),console.log("svelte-starter: 5.17.0"),console.log("build: 2024-05-25-16:58"),console.log("--- --- --- --- --- ---")}function Pa(n){let e,t,r,s;return e=new ys({props:{title:n[1],description:n[2],url:n[3],preloadFont:n[0],keywords:n[4]}}),r=new Ra({}),{c(){It(e.$$.fragment),t=Pe(),It(r.$$.fragment)},l(i){Rt(e.$$.fragment,i),t=xe(i),Rt(r.$$.fragment,i)},m(i,o){Ct(e,i,o),Ee(i,t,o),Ct(r,i,o),s=!0},p:ce,i(i){s||(ge(e.$$.fragment,i),ge(r.$$.fragment,i),s=!0)},o(i){_e(e.$$.fragment,i),_e(r.$$.fragment,i),s=!1},d(i){i&&k(t),Pt(e,i),Pt(r,i)}}}function xa(n,e,t){let{data:r}=e;Ca();const s=["https://pudding.cool/assets/fonts/tiempos/TiemposTextWeb-Regular.woff2","https://pudding.cool/assets/fonts/tiempos/TiemposTextWeb-Bold.woff2","https://pudding.cool/assets/fonts/national/National2Web-Regular.woff2","https://pudding.cool/assets/fonts/national/National2Web-Bold.woff2"],{title:i,description:o,url:a,keywords:l}=dr;return xr("copy",dr),xr("data",r.data),n.$$set=u=>{"data"in u&&t(5,r=u.data)},[s,i,o,a,l,r]}class Fa extends mt{constructor(e){super(),pt(this,e,xa,Pa,gt,{data:5})}}export{Fa as component};
